<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>STATIC ASSET MINIFIER // BRUTALIST EDITION</title><meta name="viewport" content="width=device-width,initial-scale=1"><script src="https://cdn.tailwindcss.com"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet"><style>:root{--bg-color:#F0F0EB;--surface-color:#FFFFFF;--ink-color:#121212;--accent-color:#FF3366;--secondary-color:#58CC02;--border-width:3px;--shadow-offset:5px;--radius:0px}body{background-color:var(--bg-color);color:var(--ink-color);font-family:'Space Grotesk',sans-serif;overflow-x:hidden;background-image:radial-gradient(var(--ink-color) 1px,transparent 1px);background-size:20px 20px}.font-mono{font-family:'JetBrains Mono',monospace}.brutal-shadow{box-shadow:var(--shadow-offset) var(--shadow-offset) 0 var(--ink-color);border:var(--border-width) solid var(--ink-color);transition:all .15s cubic-bezier(.25, .46, .45, .94)}.brutal-shadow:hover{transform:translate(-2px,-2px);box-shadow:calc(var(--shadow-offset) + 2px) calc(var(--shadow-offset) + 2px) 0 var(--ink-color)}.brutal-shadow:active{transform:translate(2px,2px);box-shadow:0 0 0 var(--ink-color)}.brutal-input{background:var(--surface-color);border:var(--border-width) solid var(--ink-color);color:var(--ink-color);font-family:'JetBrains Mono',monospace;outline:0;transition:.2s}.brutal-input:focus{background:#fffbeb;border-color:var(--accent-color)}.tab-btn{background:var(--bg-color);border-bottom:var(--border-width) solid transparent;color:#666;font-weight:700;text-transform:uppercase;letter-spacing:1px;position:relative;transition:.2s}.tab-btn.active{color:var(--ink-color);background:var(--surface-color);border-bottom-color:var(--ink-color)}.tab-btn.active::after{content:'';position:absolute;bottom:calc(-1 * var(--border-width) - 4px);left:0;width:100%;height:4px;background:var(--accent-color);z-index:10}.asset-item{border-left:4px solid transparent;background:rgba(255,255,255,.4);border-bottom:1px solid rgba(0,0,0,.1);transition:all .2s}.asset-item:hover .asset-controls{opacity:1}.asset-controls{opacity:0;transition:opacity .2s}.asset-item:hover{background:#fff}.asset-item.active{background:var(--surface-color);border-left-color:var(--accent-color);font-weight:700}.editor-area{background:#1a1a1a;color:#eee;border:none;font-family:'JetBrains Mono',monospace;line-height:1.5;caret-color:var(--accent-color)}#dropOverlay{background-image:repeating-linear-gradient(45deg,var(--accent-color) 0,var(--accent-color) 10px,var(--ink-color) 10px,var(--ink-color) 20px);opacity:.9;transform:scale(.98)}#usageModalOverlay{background:rgba(18,18,18,.8);backdrop-filter:blur(8px)}.modal-content{background:var(--bg-color);border:var(--border-width) solid var(--ink-color);box-shadow:10px 10px 0 var(--ink-color)}@keyframes marquee{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}.animate-marquee{white-space:nowrap;overflow:hidden;display:inline-block}.animate-marquee span{display:inline-block;animation:marquee 20s linear infinite}::-webkit-scrollbar{width:10px;height:10px}::-webkit-scrollbar-track{background:var(--bg-color);border-left:1px solid var(--ink-color)}::-webkit-scrollbar-thumb{background:var(--ink-color);border:2px solid var(--bg-color)}::-webkit-scrollbar-thumb:hover{background:var(--accent-color)}*{cursor:none!important}#cursor{position:fixed;top:0;left:0;width:25px;height:25px;background:#fff;mix-blend-mode:difference;transform:translate3d(-50%,-50%,0);pointer-events:none;z-index:10001;transition:width .2s cubic-bezier(.16, 1, .3, 1),height .2s cubic-bezier(.16, 1, .3, 1);display:block!important;visibility:visible!important;opacity:1!important}#cursor.hovered{width:50px;height:50px}</style></head><body class="min-h-screen flex flex-col" id="dropBoundary"><div id="cursor"></div><header class="p-6 md:p-8 border-b-[3px] border-[#121212] bg-[#F0F0EB]"><div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-start md:items-end gap-4"><div><div class="flex items-center gap-4 mb-2"><div class="bg-[#121212] text-[#F0F0EB] px-2 py-1 text-xs font-bold font-mono uppercase tracking-widest">v2.1.0</div><div class="h-[2px] flex-1 bg-[#121212]"></div></div><h1 class="text-4xl md:text-6xl font-bold uppercase tracking-tighter leading-none">Static Asset<br><span class="text-[#FF3366]">Minifier</span> & Bundler</h1></div><div class="max-w-xs flex flex-col items-end gap-2"><div class="flex gap-2"><button id="importProjectBtn" class="bg-[#121212] text-white text-[10px] font-bold uppercase tracking-widest px-3 py-2 hover:bg-[#58CC02] transition-colors flex items-center gap-2" title="Import Project JSON"><span>üìÇ</span> OPEN</button> <button id="exportProjectBtn" class="bg-[#121212] text-white text-[10px] font-bold uppercase tracking-widest px-3 py-2 hover:bg-[#FF3366] transition-colors flex items-center gap-2" title="Export Project JSON"><span>üíæ</span> SAVE</button> <input type="file" id="projectInput" accept=".json" class="hidden"></div><button id="openHelp" class="text-[10px] font-bold uppercase tracking-widest border-[2px] border-[#121212] px-3 py-1 hover:bg-[#121212] hover:text-white transition-all">[?] HOW TO USE</button></div></div></header><div class="flex-1 max-w-7xl mx-auto w-full p-4 md:p-6 flex flex-col gap-6"><nav class="flex w-full"><button class="tab-btn active flex-1 py-4 text-sm md:text-base border-r-[3px] border-[#121212] border-t-[3px] border-l-[3px] rounded-t-md" data-tab="workspace">Workspace</button> <button class="tab-btn flex-1 py-4 text-sm md:text-base border-r-[3px] border-[#121212] border-t-[3px] rounded-t-md" data-tab="output">Build Output</button> <button class="tab-btn flex-1 py-4 text-sm md:text-base border-t-[3px] border-r-[3px] border-l-[3px] border-[#121212] rounded-t-md" data-tab="log">Process Logs</button></nav><main class="brutal-shadow bg-white relative min-h-[600px] flex flex-col"><section id="workspace" class="tab-content block h-[600px] flex overflow-hidden"><div class="w-64 flex flex-col border-r-[3px] border-[#121212] bg-[#F8F8F3] z-10"><div class="p-4 border-b-[3px] border-[#121212] bg-[#121212] text-white"><div class="flex justify-between items-center mb-2"><span class="text-xs font-bold font-mono tracking-widest">ASSETS</span> <span id="assetCount" class="bg-[#FF3366] text-[10px] px-1.5 font-bold">0</span></div><div class="flex gap-2"><button id="addHtml" class="flex-1 bg-[#333] hover:bg-white hover:text-black text-white text-[10px] font-bold py-2 transition-colors uppercase">+HTML</button> <button id="addCss" class="flex-1 bg-[#333] hover:bg-white hover:text-black text-white text-[10px] font-bold py-2 transition-colors uppercase">+CSS</button> <button id="addJs" class="flex-1 bg-[#333] hover:bg-white hover:text-black text-white text-[10px] font-bold py-2 transition-colors uppercase">+JS</button></div></div><div id="assetList" class="flex-1 overflow-y-auto"></div></div><div class="flex-1 flex flex-col relative bg-[#121212]"><div id="noAssetPrompt" class="absolute inset-0 z-10 bg-[#121212] flex flex-col items-center justify-center p-12 text-center"><div class="w-20 h-20 border-4 border-[#333] flex items-center justify-center mb-6 animate-pulse"><svg class="w-10 h-10 text-[#555]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg></div><h3 class="text-xl font-bold text-[#333] uppercase tracking-widest mb-2">System Ready</h3><p class="text-sm font-mono text-[#555] max-w-xs leading-relaxed">[WAITING FOR INPUT]<br>Drag files anywhere to import.<br>Or use buttons to create new assets.</p></div><div id="editorHeader" class="hidden h-12 bg-[#1e1e1e] border-b border-[#333] flex items-center justify-between px-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div><span id="currentFileName" class="text-sm font-mono text-[#888] ml-4">Select an asset</span></div><button id="removeAsset" class="text-[10px] font-bold text-red-500 hover:text-red-400 border border-red-900 bg-red-900/20 px-3 py-1 uppercase tracking-wider hover:bg-red-500 hover:text-white transition-all">Delete File</button></div><textarea id="mainEditor" class="editor-area hidden flex-1 w-full p-6 text-sm resize-none focus:bg-[#1a1a1a]" placeholder="// Write code here..."></textarea><div id="mediaView" class="hidden flex-1 flex flex-col items-center justify-center bg-[#121212] p-10 overflow-hidden relative"><div class="absolute inset-0 opacity-10" style="background-image:linear-gradient(#333 1px,transparent 1px),linear-gradient(90deg,#333 1px,transparent 1px);background-size:20px 20px"></div><div class="relative z-10 text-center"><div class="text-[10px] font-bold text-[#555] mb-4 uppercase tracking-widest border-b border-[#333] inline-block pb-1">Binary Asset Preview</div><div class="border-4 border-[#333] bg-[#000] p-2 inline-block shadow-[8px_8px_0_#333]"><img id="imgPreview" class="max-w-full max-h-[350px] block" src="" alt=""></div><div id="base64Summary" class="mt-4 text-[10px] font-mono text-[#444] break-all max-w-md text-center border border-[#333] p-2 bg-[#1a1a1a]">...</div></div></div><div id="dropOverlay" class="absolute inset-0 pointer-events-none z-50 flex items-center justify-center transition-all duration-200 hidden"><div class="bg-[#F0F0EB] border-[5px] border-[#121212] px-12 py-8 shadow-[12px_12px_0_#000]"><h2 class="text-4xl font-black uppercase tracking-tighter animate-pulse">Drop Files</h2></div></div></div></section><section id="output" class="tab-content hidden p-6 md:p-10 flex flex-col h-full gap-8"><div class="flex flex-col gap-6 p-6 bg-[#F8F8F3] border-[3px] border-[#121212] shadow-[6px_6px_0_#121212]"><div class="flex flex-wrap items-end justify-between gap-4"><div class="flex flex-col gap-2"><label class="text-[10px] font-bold uppercase tracking-widest text-[#666]">Build Mode</label><div class="relative"><select id="mode" class="brutal-input px-4 py-3 text-sm font-bold appearance-none pr-10 cursor-pointer w-64"><option value="inline">Single HTML Bundle (Inline)</option><option value="separate">Multi-file Minification</option></select><div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none font-bold">‚ñº</div></div></div><div class="flex items-center gap-4"><div id="build-status" class="hidden text-[#FF3366] font-bold font-mono text-sm uppercase animate-pulse">// OPTIMIZING...</div><button id="build" class="bg-[#121212] hover:bg-[#FF3366] text-white text-sm font-black py-4 px-12 uppercase tracking-widest shadow-[4px_4px_0_#FF3366] hover:shadow-[6px_6px_0_#FF3366] hover:translate-x-[-2px] hover:translate-y-[-2px] transition-all flex items-center gap-2"><span id="buildIcon">‚ö°</span> Run Build</button></div></div><div class="pt-4 border-t border-[#ccc] grid grid-cols-1 md:grid-cols-2 gap-6"><div class="flex flex-col gap-3"><label class="text-[10px] font-bold uppercase tracking-widest text-[#666]">Optimization</label><div class="flex items-center gap-4"><label class="flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="optMinify" checked="checked" class="w-4 h-4 accent-[#FF3366]"> <span class="text-xs font-mono font-bold">Enable Minification</span></label> <label class="flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="optComments" checked="checked" class="w-4 h-4 accent-[#FF3366]"> <span class="text-xs font-mono font-bold">Remove Comments</span></label> <label class="flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="optConsole" checked="checked" class="w-4 h-4 accent-[#FF3366]"> <span class="text-xs font-mono font-bold">Drop Console</span></label></div></div><div class="flex flex-col gap-3"><label class="text-[10px] font-bold uppercase tracking-widest text-[#666]">Change Target Filenames</label><div class="flex gap-2"><input id="outNameH" class="brutal-input p-2 text-xs w-full" placeholder="index.min.html" value="index.min.html"> <input id="outNameC" class="brutal-input p-2 text-xs w-full" placeholder="styles.min.css" value="styles.min.css"> <input id="outNameJ" class="brutal-input p-2 text-xs w-full" placeholder="scripts.min.js" value="scripts.min.js"></div></div></div></div><div class="grid grid-cols-1 lg:grid-cols-3 gap-8 h-full"><div class="lg:col-span-2 space-y-6"><div class="border-[3px] border-[#121212] h-[400px] bg-white shadow-[4px_4px_0_#121212] flex flex-col"><div class="bg-[#121212] text-white px-4 py-2 text-xs font-mono flex justify-between items-center"><span>LIVE PREVIEW</span><div class="flex items-center gap-2"><button id="openNewTab" class="hover:text-[#58CC02] transition-colors text-[10px] border border-[#555] px-2 py-0.5">NEW TAB</button> <button id="togglePreview" class="hover:text-[#FF3366] transition-colors text-[10px] border border-[#555] px-2 py-0.5">TOGGLE PREVIEW</button></div></div><div id="previewBox" class="flex-1 overflow-hidden bg-white relative"><iframe id="previewFrame" class="w-full h-full border-none"></iframe></div></div></div><div class="space-y-4"><h3 class="text-xs font-black uppercase border-b-2 border-[#121212] pb-1 mb-4">Output Artifacts</h3><button id="downH" class="w-full group text-left p-4 border-[3px] border-[#121212] bg-white hover:bg-[#121212] hover:text-white transition-all hidden"><div class="flex justify-between items-center"><span id="lblH" class="font-bold font-mono text-sm">index.min.html</span> <span class="text-xs opacity-0 group-hover:opacity-100 transition-opacity">‚Üì</span></div></button> <button id="downC" class="w-full group text-left p-4 border-[3px] border-[#121212] bg-white hover:bg-[#121212] hover:text-white transition-all hidden"><div class="flex justify-between items-center"><span id="lblC" class="font-bold font-mono text-sm">styles.min.css</span> <span class="text-xs opacity-0 group-hover:opacity-100 transition-opacity">‚Üì</span></div></button> <button id="downJ" class="w-full group text-left p-4 border-[3px] border-[#121212] bg-white hover:bg-[#121212] hover:text-white transition-all hidden"><div class="flex justify-between items-center"><span id="lblJ" class="font-bold font-mono text-sm">scripts.min.js</span> <span class="text-xs opacity-0 group-hover:opacity-100 transition-opacity">‚Üì</span></div></button><div class="pt-4 border-t border-dashed border-[#121212]"><button id="downA" class="w-full bg-[#FF3366] text-white font-black uppercase text-xs py-4 shadow-[4px_4px_0_#121212] active:translate-x-1 active:translate-y-1 active:shadow-none transition-all">Download Bundle</button></div></div></div><div id="diffContainer" class="border-[3px] border-[#121212] bg-white shadow-[4px_4px_0_#121212] flex flex-col mt-6 w-[95vw] relative left-1/2 -translate-x-1/2"><div class="bg-[#121212] text-white px-4 py-2 text-xs font-mono flex justify-between items-center"><span>CODE DIFFERENCE</span><div class="flex items-center gap-3"><label class="flex items-center gap-1 cursor-pointer select-none"><input type="checkbox" id="diffCollapseBase64" checked="checked" class="w-3 h-3 accent-[#FF3366]"> <span class="text-[10px]">COLLAPSE BASE64</span></label> <label class="flex items-center gap-1 cursor-pointer select-none"><input type="checkbox" id="diffWrap" checked="checked" class="w-3 h-3 accent-[#FF3366]"> <span class="text-[10px]">WRAP TEXT</span></label></div></div><div class="flex-1 flex flex-col md:flex-row h-[600px] border-t border-[#333]"><div class="flex-1 min-w-0 flex flex-col border-b md:border-b-0 md:border-r border-[#333]"><div class="bg-[#eee] px-2 py-1 text-[10px] font-bold text-[#555] uppercase border-b border-[#ccc]">Original (Combined)</div><pre id="diffOriginal" class="flex-1 p-4 font-mono text-xs overflow-auto text-[#444] leading-relaxed whitespace-pre-wrap"></pre></div><div class="flex-1 min-w-0 flex flex-col"><div class="bg-[#eee] px-2 py-1 text-[10px] font-bold text-[#555] uppercase border-b border-[#ccc]">Build Output</div><pre id="diffOutput" class="flex-1 p-4 font-mono text-xs overflow-auto text-[#444] leading-relaxed whitespace-pre-wrap"></pre></div></div></div></section><section id="log" class="tab-content hidden p-0 h-[600px] flex flex-col bg-[#121212]"><div class="bg-[#222] px-4 py-2 text-xs text-[#888] font-mono border-b border-[#333] flex justify-between"><span>> TERMINAL OUTPUT</span> <span class="text-[#FF3366]">‚óè LIVE</span></div><div id="logBox" class="flex-1 overflow-y-auto p-6 font-mono text-xs md:text-sm leading-relaxed text-[#ccc]"><div class="text-[#555] italic">> System initialized. Waiting for user input...</div></div></section></main></div><div id="usageModalOverlay" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4"><div class="modal-content w-full max-w-3xl max-h-[85vh] flex flex-col"><div class="p-6 border-b-[3px] border-[#121212] bg-[#F8F8F3] flex justify-between items-start"><div><h2 class="text-2xl font-black uppercase tracking-tighter">Image Usage Review</h2><p class="text-xs font-mono text-[#666] mt-1">Detected references in source code.</p></div><div class="w-3 h-3 bg-[#FF3366] rounded-full animate-ping"></div></div><div class="flex-1 overflow-y-auto p-8 space-y-8"><div id="referencedSection"><h3 class="text-[10px] font-bold uppercase tracking-[0.2em] text-[#121212] mb-4 border-l-4 border-[#58CC02] pl-3 bg-green-100 inline-block py-1">Referenced Assets (Keep)</h3><div id="referencedList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div><div id="unreferencedSection"><h3 class="text-[10px] font-bold uppercase tracking-[0.2em] text-[#121212] mb-4 border-l-4 border-[#FF3366] pl-3 bg-red-100 inline-block py-1">Unused Assets (Delete)</h3><div id="unreferencedList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div></div><div class="p-6 border-t-[3px] border-[#121212] bg-[#F8F8F3] flex gap-4"><button id="modalCancel" class="flex-1 py-4 border-[3px] border-[#121212] text-[#121212] text-xs font-bold uppercase hover:bg-[#121212] hover:text-white transition-colors">Cancel</button> <button id="modalProceed" class="flex-1 py-4 bg-[#58CC02] border-[3px] border-[#121212] text-white text-xs font-bold uppercase shadow-[4px_4px_0_#121212] hover:translate-x-[-1px] hover:translate-y-[-1px] hover:shadow-[5px_5px_0_#121212] transition-all">Proceed & Clean</button></div></div></div><div id="helpModalOverlay" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4"><div class="modal-content w-full max-w-2xl max-h-[85vh] flex flex-col"><div class="p-6 border-b-[3px] border-[#121212] bg-[#F8F8F3] flex justify-between items-start"><h2 class="text-2xl font-black uppercase tracking-tighter">System Manual</h2><button id="closeHelp" class="text-xl font-bold hover:text-[#FF3366]">‚úï</button></div><div class="p-8 overflow-y-auto space-y-6 font-mono text-sm"><div><h3 class="font-bold text-[#FF3366] uppercase mb-2">> 1. Asset Order Matters</h3><p class="text-[#555]">Files are processed in the order shown in the Workspace list.<br>- <strong>CSS:</strong> Lower files can override earlier ones.<br>- <strong>JS:</strong> Dependencies must appear <em>before</em> the scripts that use them.<br>Use the <span class="bg-[#121212] text-white px-1 text-xs">‚Üë</span> <span class="bg-[#121212] text-white px-1 text-xs">‚Üì</span> arrows to reorder.</p></div><div><h3 class="font-bold text-[#FF3366] uppercase mb-2">> 2. Entry Point</h3><p class="text-[#555]">The <strong>FIRST</strong> HTML file in the list is treated as the "Entry Point".<br>All other content (CSS, JS, inlined images) is injected into this file.</p></div><div><h3 class="font-bold text-[#FF3366] uppercase mb-2">> 3. Protected Build</h3><p class="text-[#555]">Unused images are detected automatically. You will be asked to confirm their deletion before building to keep bundle size small.<br><strong>Note:</strong> JS minification is performed safely without mutating variable names that might reference DOM elements.</p></div></div></div></div><script type="module">import{minify as minifyHTML}from"https://esm.sh/html-minifier-terser";import CleanCSS from"https://esm.sh/clean-css";import{minify as minifyJS}from"https://esm.sh/terser";import*as Diff from"https://esm.sh/diff";let assets=[],activeAssetId=null,outputs={html:"",css:"",js:""},originalCombined="";const logBox=document.getElementById("logBox"),assetList=document.getElementById("assetList"),mainEditor=document.getElementById("mainEditor"),mediaView=document.getElementById("mediaView"),imgPreview=document.getElementById("imgPreview"),base64Summary=document.getElementById("base64Summary"),currentFileName=document.getElementById("currentFileName"),buildStatus=document.getElementById("build-status"),noAssetPrompt=document.getElementById("noAssetPrompt"),editorHeader=document.getElementById("editorHeader"),assetCount=document.getElementById("assetCount"),usageModal=document.getElementById("usageModalOverlay"),refList=document.getElementById("referencedList"),unrefList=document.getElementById("unreferencedList"),modalProceed=document.getElementById("modalProceed"),modalCancel=document.getElementById("modalCancel"),log=e=>{1===logBox.children.length&&logBox.querySelector(".italic")&&(logBox.innerHTML="");const t=document.createElement("div");t.className="log-line border-l-2 border-[#333] pl-3 py-1 mb-2 hover:bg-white/5 transition-colors";const s=(new Date).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});t.innerHTML=`<span class="text-[#555] font-mono mr-3">[${s}]</span> ${e}`,logBox.appendChild(t),logBox.scrollTop=logBox.scrollHeight},formatBytes=(e,t=1)=>{if(!+e)return"0 B";const s=t<0?0:t,n=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,n)).toFixed(s))} ${["B","KB","MB","GB"][n]}`},renderAssetList=()=>{if(assetList.innerHTML="",assetCount.innerText=assets.length,0===assets.length)return noAssetPrompt.classList.remove("hidden"),editorHeader.classList.add("hidden"),mainEditor.classList.add("hidden"),void mediaView.classList.add("hidden");noAssetPrompt.classList.add("hidden"),editorHeader.classList.remove("hidden");const e=assets.find(e=>"html"===e.type)?.id;assets.forEach((t,s)=>{const n=document.createElement("div");n.className="asset-item px-4 py-3 cursor-pointer flex justify-between items-center group relative "+(t.id===activeAssetId?"active":"");const o="media"===t.type?.75*t.content.length:new Blob([t.content]).size,d=formatBytes(o);let a="üìÑ";"css"===t.type&&(a="üé®"),"js"===t.type&&(a="‚ö°"),"media"===t.type&&(a="üñºÔ∏è");const i=t.id===e;n.innerHTML=`\n          <div class="flex items-center gap-3 overflow-hidden flex-1" onclick="selectAsset('${t.id}')">\n            <span class="text-lg">${a}</span>\n            <div class="min-w-0 flex-1">\n              <div class="flex items-center gap-2">\n                <span class="text-xs font-mono font-bold truncate ${t.id===activeAssetId?"text-[#121212]":"text-[#666]"} group-hover:text-[#121212] transition-colors">${t.name}</span>\n                ${i?'<span class="text-[8px] bg-[#121212] text-white px-1 font-bold uppercase tracking-wider">ENTRY</span>':""}\n              </div>\n              <span class="text-[9px] text-[#888] font-mono">${d} ‚Ä¢ ${t.type.toUpperCase()}</span>\n            </div>\n          </div>\n          \n          <div class="asset-controls flex items-center gap-1 pl-2">\n             <button onclick="moveAsset('${t.id}', -1)" class="p-1 hover:bg-[#121212] hover:text-white rounded text-[#555] transition-colors" title="Move Up">‚Üë</button>\n             <button onclick="moveAsset('${t.id}', 1)" class="p-1 hover:bg-[#121212] hover:text-white rounded text-[#555] transition-colors" title="Move Down">‚Üì</button>\n             <button onclick="duplicateAsset('${t.id}')" class="p-1 hover:bg-[#121212] hover:text-white rounded text-[#555] transition-colors" title="Duplicate">‚ùê</button>\n             <button onclick="renameAsset('${t.id}')" class="p-1 hover:bg-[#121212] hover:text-white rounded text-[#555] transition-colors" title="Rename">‚úé</button>\n          </div>\n        `,assetList.appendChild(n)})},showToast=(e,t="info")=>{const s=document.createElement("div"),n="error"===t?"#FF3366":"#58CC02";s.className=`fixed bottom-8 right-8 bg-[#121212] text-white px-6 py-4 font-bold uppercase tracking-wider shadow-[4px_4px_0_${n}] transition-all duration-300 transform translate-y-20 opacity-0 z-[200] border-l-4 border-[${n}]`,s.innerHTML=`<span style="color:${n}">></span> ${e}`,document.body.appendChild(s),requestAnimationFrame(()=>{s.classList.remove("translate-y-20","opacity-0")}),setTimeout(()=>{s.classList.add("translate-y-20","opacity-0"),setTimeout(()=>s.remove(),300)},3e3)};window.selectAsset=e=>{if(!e)return activeAssetId=null,void renderAssetList();const t=assets.find(e=>e.id===activeAssetId);t&&"media"!==t.type&&(t.content=mainEditor.value),activeAssetId=e;const s=assets.find(t=>t.id===e);s&&(currentFileName.innerText=s.name,"media"===s.type?(mainEditor.classList.add("hidden"),mediaView.classList.remove("hidden"),imgPreview.src=s.content,base64Summary.innerText=s.content.substring(0,80)+"..."):(mainEditor.classList.remove("hidden"),mediaView.classList.add("hidden"),mainEditor.value=s.content),renderAssetList())},window.moveAsset=(e,t)=>{const s=assets.findIndex(t=>t.id===e);if(s<0)return;const n=s+t;n<0||n>=assets.length||([assets[s],assets[n]]=[assets[n],assets[s]],renderAssetList())},window.renameAsset=e=>{const t=assets.find(t=>t.id===e);if(!t)return;const s=prompt("Rename asset:",t.name);s&&""!==s.trim()&&(t.name=s.trim(),activeAssetId===e&&(currentFileName.innerText=t.name),renderAssetList())},window.duplicateAsset=e=>{const t=assets.find(t=>t.id===e);if(!t)return;const s=crypto.randomUUID(),n=t.name.replace(/(\.[^.]*)?$/," (Copy)$1");assets.push({id:s,type:t.type,name:n,content:t.content}),log(`Duplicated: ${t.name} -> ${n}`),showToast("Asset Duplicated"),selectAsset(s)},document.getElementById("exportProjectBtn").onclick=()=>{const e=assets.find(e=>e.id===activeAssetId);e&&"media"!==e.type&&(e.content=mainEditor.value);const t=JSON.stringify(assets),s=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(s),o=document.createElement("a");o.href=n,o.download=`bundler-project-${(new Date).toISOString().slice(0,10)}.json`,o.click(),URL.revokeObjectURL(n),log("Project exported successfully."),showToast("Project Saved")},document.getElementById("importProjectBtn").onclick=()=>{document.getElementById("projectInput").click()},document.getElementById("projectInput").onchange=e=>{const t=e.target.files[0];if(!t)return;const s=new FileReader;s.onload=e=>{try{const t=JSON.parse(e.target.result);if(!Array.isArray(t))throw new Error("Invalid project file format");assets=t,activeAssetId=null,log("Project imported successfully."),showToast("Project Loaded","success"),assets.length>0?selectAsset(assets[0].id):renderAssetList()}catch(e){console.error(e),log(`<span class="text-[#FF3366]">Import Error:</span> ${e.message}`),showToast("Load Failed: Invalid File","error")}},s.readAsText(t),e.target.value=""};const addAsset=(e,t,s)=>{const n=crypto.randomUUID();assets.push({id:n,type:e,name:t,content:s}),log(`Imported: <span class="text-[#58CC02] font-bold">${t}</span>`),selectAsset(n)},helpModal=document.getElementById("helpModalOverlay");document.getElementById("openHelp").onclick=()=>helpModal.classList.remove("hidden"),document.getElementById("closeHelp").onclick=()=>helpModal.classList.add("hidden"),helpModal.onclick=e=>{e.target===helpModal&&helpModal.classList.add("hidden")},document.getElementById("addHtml").onclick=()=>addAsset("html",`page-${assets.filter(e=>"html"===e.type).length+1}.html`,"<!DOCTYPE html>\n<html>\n<body>\n  \n</body>\n</html>"),document.getElementById("addCss").onclick=()=>addAsset("css",`style-${assets.filter(e=>"css"===e.type).length+1}.css`,"/* Styles */\n"),document.getElementById("addJs").onclick=()=>addAsset("js",`script-${assets.filter(e=>"js"===e.type).length+1}.js`,"// Script\n"),document.getElementById("removeAsset").onclick=()=>{const e=assets.find(e=>e.id===activeAssetId);e&&log(`Deleted asset: ${e.name}`),assets=assets.filter(e=>e.id!==activeAssetId),assets.length>0?selectAsset(assets[assets.length-1].id):selectAsset(null)},document.querySelectorAll(".tab-btn").forEach(e=>{e.onclick=()=>{document.querySelectorAll(".tab-btn").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(e=>e.classList.add("hidden")),e.classList.add("active"),document.getElementById(e.dataset.tab).classList.remove("hidden")}});const dropBoundary=document.getElementById("dropBoundary"),dropOverlay=document.getElementById("dropOverlay");dropBoundary.addEventListener("dragover",e=>{e.preventDefault(),dropOverlay.classList.remove("hidden")}),dropBoundary.addEventListener("dragleave",e=>{null!==e.relatedTarget&&e.relatedTarget!==dropBoundary||dropOverlay.classList.add("hidden")}),dropBoundary.addEventListener("drop",async e=>{e.preventDefault(),dropOverlay.classList.add("hidden");const t=Array.from(e.dataTransfer.files);if(0!==t.length)for(const e of t){const t=e.name.split(".").pop().toLowerCase();if(["png","jpg","jpeg","gif","svg","webp","ico"].includes(t)){const t=new FileReader;t.onload=t=>addAsset("media",e.name,t.target.result),t.readAsDataURL(e)}else{const s=await e.text();["html","htm"].includes(t)?addAsset("html",e.name,s):"css"===t?addAsset("css",e.name,s):"js"===t&&addAsset("js",e.name,s)}}});const scanImageUsage=()=>{const e=assets.filter(e=>"media"===e.type),t=assets.filter(e=>"html"===e.type).map(e=>e.content).join(" "),s=assets.filter(e=>"css"===e.type).map(e=>e.content).join(" "),n=[],o=[];return e.forEach(e=>{const d=e.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=new RegExp(`(src|href)=["']([^"']*\\/)?${d}["']`,"i"),i=new RegExp(`url\\(\\s*["']?([^"')]*\\/)?${d}["']?\\s*\\)`,"i");let l=[];a.test(t)&&l.push("HTML"),i.test(s)&&l.push("CSS"),l.length>0?n.push({...e,foundIn:l}):o.push(e)}),{used:n,unused:o}},showUsageModal=(e,t)=>{refList.innerHTML="",unrefList.innerHTML="",e.forEach(e=>{const t=document.createElement("div");t.className="flex items-center gap-4 bg-white border-[3px] border-[#121212] p-3 shadow-[3px_3px_0_#000]",t.innerHTML=`\n            <img src="${e.content}" class="w-12 h-12 object-cover border border-[#333]">\n            <div class="flex-1 min-w-0">\n                <div class="font-mono text-xs font-bold truncate text-[#121212]">${e.name}</div>\n                <div class="text-[10px] uppercase text-[#58CC02] font-bold">Found in ${e.foundIn.join(" & ")}</div>\n            </div>\n            <div class="w-2 h-2 bg-[#58CC02] rounded-full"></div>\n        `,refList.appendChild(t)}),t.forEach(e=>{const t=document.createElement("div");t.className="flex items-center gap-4 bg-[#F8F8F3] border-[3px] border-[#ccc] p-3 opacity-70",t.innerHTML=`\n            <img src="${e.content}" class="w-12 h-12 object-cover grayscale border border-[#333]">\n            <div class="flex-1 min-w-0">\n                <div class="font-mono text-xs font-bold truncate text-[#666]">${e.name}</div>\n                <div class="text-[10px] uppercase text-[#FF3366] font-bold">Unused</div>\n            </div>\n        `,unrefList.appendChild(t)}),usageModal.classList.remove("hidden")};modalCancel.onclick=()=>usageModal.classList.add("hidden"),modalProceed.onclick=()=>{usageModal.classList.add("hidden");const{unused:e}=scanImageUsage();assets=assets.filter(t=>!e.find(e=>e.id===t.id)),renderAssetList(),log(`<span class="text-[#FF3366] font-bold">Purged ${e.length} unused media assets.</span>`),executeBuild()},document.getElementById("build").onclick=()=>{const e=assets.find(e=>e.id===activeAssetId);e&&"media"!==e.type&&(e.content=mainEditor.value);const{used:t,unused:s}=scanImageUsage();s.length>0?showUsageModal(t,s):executeBuild()};const diffContainer=document.getElementById("diffContainer"),previewBox=document.getElementById("previewBox"),diffOriginal=document.getElementById("diffOriginal"),diffOutput=document.getElementById("diffOutput"),generateDiff=()=>{if(!outputs.html)return;const e=document.getElementById("diffCollapseBase64").checked,t=document.getElementById("diffWrap").checked;diffOriginal.className="flex-1 p-4 font-mono text-xs overflow-auto text-[#444] leading-relaxed "+(t?"whitespace-pre-wrap break-all":"whitespace-pre"),diffOutput.className="flex-1 p-4 font-mono text-xs overflow-auto text-[#444] leading-relaxed "+(t?"whitespace-pre-wrap break-all":"whitespace-pre");let s=originalCombined||"",n=outputs.html||"";if(e){const e=/data:image\/[^;]+;base64,[a-zA-Z0-9+/=]+/g,t="[...BASE64 DATA REMOVED FOR CLARITY...]";s=s.replace(e,t),n=n.replace(e,t)}const o=Diff.diffWords(s,n);let d="";o.forEach(e=>{const t=e.added?"bg-green-200 text-green-900 font-bold":e.removed?"hidden":"text-gray-500";e.removed||(d+=`<span class="${t}">${e.value.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</span>`)});let a="";o.forEach(e=>{const t=e.removed?"bg-red-200 text-red-900 font-bold":e.added?"hidden":"text-gray-500";e.added||(a+=`<span class="${t}">${e.value.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</span>`)}),diffOriginal.innerHTML=a,diffOutput.innerHTML=d};document.getElementById("openNewTab").onclick=()=>{if(!outputs.html)return void showToast("Build first to preview in new tab!",!0);const e=new Blob([outputs.html],{type:"text/html"}),t=URL.createObjectURL(e);window.open(t,"_blank")},document.getElementById("diffCollapseBase64").onchange=generateDiff,document.getElementById("diffWrap").onchange=generateDiff;const executeBuild=async()=>{const e=assets.find(e=>"html"===e.type);if(!e)return void log("<span class='text-[#FF3366]'>Error:</span> No HTML entry found.");buildStatus.classList.remove("hidden"),log("Starting protected build sequence..."),showToast("Build Started...");const t=document.getElementById("mode").value,s=document.getElementById("optMinify").checked,n=document.getElementById("optComments").checked,o=document.getElementById("optConsole").checked;let d=e.content,a=assets.filter(e=>"css"===e.type).map(e=>e.content).join("\n"),i=assets.filter(e=>"js"===e.type).map(e=>e.content).join("\n");const l=assets.filter(e=>"media"===e.type);let c=d,r=a;try{if(s){if(a&&(a=(new CleanCSS).minify(a).styles),i){const e={compress:{drop_console:o}};i=(await minifyJS(i,e)).code}}else if(log("Minification skipped (Combine Only Mode). Running partial optimization..."),n&&a&&(a=a.replace(/\/\*[\s\S]*?\*\//g,"")),(n||o)&&i){const e={compress:{drop_console:o,defaults:!1},mangle:!1,format:{beautify:!0,comments:!n}};i=(await minifyJS(i,e)).code}if("inline"===t&&l.length>0&&(log(`Inlining ${l.length} assets...`),l.forEach(e=>{const t=e.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=new RegExp(`(['"\\(])(?:[^'"\\(\\)]*?\\/)?${t}(['"\\)])`,"g"),n=(t,s,n)=>`${s}${e.content}${n}`;d=d.replace(s,n),a&&(a=a.replace(s,n)),c=c.replace(s,n),r&&(r=r.replace(s,n))})),"inline"===t){a&&(d=d.replace("</head>",`<style>${a}</style></head>`)),i&&(d=d.replace("</body>",`<script>${i}<\/script></body>`)),r&&(c=c.replace("</head>",`<style>${r}</style></head>`));const e=assets.filter(e=>"js"===e.type).map(e=>e.content).join("\n");e&&(c=c.replace("</body>",`<script>${e}<\/script></body>`))}originalCombined=c,s?d=await minifyHTML(d,{collapseWhitespace:!0,removeComments:n,minifyCSS:!0,minifyJS:!0}):n&&(d=await minifyHTML(d,{collapseWhitespace:!1,removeComments:!0,minifyCSS:!1,minifyJS:!1})),outputs={html:d,css:a,js:i},document.getElementById("previewFrame").srcdoc=d,generateDiff();const e=document.getElementById("outNameH").value||"index.min.html",m=document.getElementById("outNameC").value||"styles.min.css",u=document.getElementById("outNameJ").value||"scripts.min.js";document.getElementById("lblH").innerText=e,document.getElementById("lblC").innerText=m,document.getElementById("lblJ").innerText=u,document.getElementById("downH").classList.remove("hidden"),outputs.css&&document.getElementById("downC").classList.remove("hidden"),outputs.js&&document.getElementById("downJ").classList.remove("hidden"),log("<span class='text-[#58CC02] font-bold'>Build Complete.</span> Outputs generated."),showToast("Build Success!","success"),document.querySelector('[data-tab="output"]').click()}catch(e){log(`<span class="text-[#FF3366]">Error:</span> ${e.message}`),showToast("Build Failed","error")}finally{buildStatus.classList.add("hidden")}},dl=(e,t)=>{if(!t)return;const s=document.createElement("a");s.href=URL.createObjectURL(new Blob([t],{type:"text/plain"})),s.download=e,s.click()};document.getElementById("downH").onclick=()=>dl(document.getElementById("outNameH").value||"index.min.html",outputs.html),document.getElementById("downC").onclick=()=>dl(document.getElementById("outNameC").value||"styles.min.css",outputs.css),document.getElementById("downJ").onclick=()=>dl(document.getElementById("outNameJ").value||"scripts.min.js",outputs.js),document.getElementById("downA").onclick=()=>{dl(document.getElementById("outNameH").value||"index.min.html",outputs.html),outputs.css&&dl(document.getElementById("outNameC").value||"styles.min.css",outputs.css),outputs.js&&dl(document.getElementById("outNameJ").value||"scripts.min.js",outputs.js)},document.getElementById("togglePreview").onclick=()=>{document.getElementById("previewBox").classList.toggle("hidden")};const cursor=document.getElementById("cursor");if(cursor){document.addEventListener("mousemove",e=>{cursor.style.transform=`translate3d(calc(${e.clientX}px - 50%), calc(${e.clientY}px - 50%), 0)`});const e="a, button, .tab-btn, .asset-item";document.addEventListener("mouseover",t=>{t.target.closest(e)&&cursor.classList.add("hovered")}),document.addEventListener("mouseout",t=>{t.target.closest(e)&&cursor.classList.remove("hovered")})}renderAssetList()</script></body></html>