<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>STATIC ASSET MINIFIER // BRUTALIST EDITION</title><meta name="viewport" content="width=device-width,initial-scale=1"><script src="https://cdn.tailwindcss.com"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet"><style>:root{--bg-color:#F0F0EB;--surface-color:#FFFFFF;--ink-color:#121212;--accent-color:#FF3366;--secondary-color:#58CC02;--border-width:3px;--shadow-offset:5px;--radius:0px}body{background-color:var(--bg-color);color:var(--ink-color);font-family:'Space Grotesk',sans-serif;overflow-x:hidden;background-image:radial-gradient(var(--ink-color) 1px,transparent 1px);background-size:20px 20px}.font-mono{font-family:'JetBrains Mono',monospace}.brutal-shadow{box-shadow:var(--shadow-offset) var(--shadow-offset) 0 var(--ink-color);border:var(--border-width) solid var(--ink-color);transition:all .15s cubic-bezier(.25, .46, .45, .94)}.brutal-shadow:hover{transform:translate(-2px,-2px);box-shadow:calc(var(--shadow-offset) + 2px) calc(var(--shadow-offset) + 2px) 0 var(--ink-color)}.brutal-shadow:active{transform:translate(2px,2px);box-shadow:0 0 0 var(--ink-color)}.brutal-input{background:var(--surface-color);border:var(--border-width) solid var(--ink-color);color:var(--ink-color);font-family:'JetBrains Mono',monospace;outline:0;transition:.2s}.brutal-input:focus{background:#fffbeb;border-color:var(--accent-color)}.tab-btn{background:var(--bg-color);border-bottom:var(--border-width) solid transparent;color:#666;font-weight:700;text-transform:uppercase;letter-spacing:1px;position:relative;transition:.2s}.tab-btn.active{color:var(--ink-color);background:var(--surface-color);border-bottom-color:var(--ink-color)}.tab-btn.active::after{content:'';position:absolute;bottom:calc(-1 * var(--border-width) - 4px);left:0;width:100%;height:4px;background:var(--accent-color);z-index:10}.asset-item{border-left:4px solid transparent;background:rgba(255,255,255,.4);border-bottom:1px solid rgba(0,0,0,.1)}.asset-item:hover{background:#fff}.asset-item.active{background:var(--surface-color);border-left-color:var(--accent-color);font-weight:700}.editor-area{background:#1a1a1a;color:#eee;border:none;font-family:'JetBrains Mono',monospace;line-height:1.6;caret-color:var(--accent-color);background-image:linear-gradient(#333 1px,transparent 1px);background-size:100% 1.6em}#dropOverlay{background-image:repeating-linear-gradient(45deg,var(--accent-color) 0,var(--accent-color) 10px,var(--ink-color) 10px,var(--ink-color) 20px);opacity:.9;transform:scale(.98)}#usageModalOverlay{background:rgba(18,18,18,.8);backdrop-filter:blur(8px)}.modal-content{background:var(--bg-color);border:var(--border-width) solid var(--ink-color);box-shadow:10px 10px 0 var(--ink-color)}@keyframes marquee{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}.animate-marquee{white-space:nowrap;overflow:hidden;display:inline-block}.animate-marquee span{display:inline-block;animation:marquee 20s linear infinite}::-webkit-scrollbar{width:10px;height:10px}::-webkit-scrollbar-track{background:var(--bg-color);border-left:1px solid var(--ink-color)}::-webkit-scrollbar-thumb{background:var(--ink-color);border:2px solid var(--bg-color)}::-webkit-scrollbar-thumb:hover{background:var(--accent-color)}#toast-container{position:fixed;top:20px;right:20px;z-index:9999;display:flex;flex-direction:column;gap:10px}.toast{background:var(--surface-color);border:var(--border-width) solid var(--ink-color);box-shadow:4px 4px 0 var(--ink-color);padding:1rem;min-width:250px;animation:slideIn .3s ease-out forwards;font-family:'Space Grotesk',sans-serif;font-weight:700;display:flex;align-items:center;justify-content:space-between}@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes fadeOut{to{opacity:0;transform:translateY(-10px)}}</style></head><body class="min-h-screen flex flex-col" id="dropBoundary"><div id="toast-container"></div><header class="p-6 md:p-8 border-b-[3px] border-[#121212] bg-[#F0F0EB]"><div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-start md:items-end gap-4"><div><div class="flex items-center gap-4 mb-2"><div class="bg-[#121212] text-[#F0F0EB] px-2 py-1 text-xs font-bold font-mono uppercase tracking-widest">v2.1.0 // PERSISTENT</div><div class="h-[2px] flex-1 bg-[#121212]"></div></div><h1 class="text-4xl md:text-6xl font-bold uppercase tracking-tighter leading-none">Static Asset<br><span class="text-[#FF3366]">Minifier</span> & Bundler</h1></div><div class="max-w-xs"><p class="text-sm font-mono leading-relaxed border-l-2 border-[#121212] pl-3">// Auto-save enabled.<br>// Tab key indentation support.<br>// Drag & drop files to begin.</p></div></div></header><div class="flex-1 max-w-7xl mx-auto w-full p-4 md:p-6 flex flex-col gap-6"><nav class="flex w-full"><button class="tab-btn active flex-1 py-4 text-sm md:text-base border-r-[3px] border-[#121212] border-t-[3px] border-l-[3px] rounded-t-md" data-tab="workspace">Workspace</button> <button class="tab-btn flex-1 py-4 text-sm md:text-base border-r-[3px] border-[#121212] border-t-[3px] rounded-t-md" data-tab="output">Build Output</button> <button class="tab-btn flex-1 py-4 text-sm md:text-base border-t-[3px] border-r-[3px] border-l-[3px] border-[#121212] rounded-t-md" data-tab="log">Process Logs</button></nav><main class="brutal-shadow bg-white relative min-h-[600px] flex flex-col overflow-hidden"><section id="workspace" class="tab-content block h-[600px] flex overflow-hidden relative"><button id="sidebarToggle" class="absolute top-2 left-2 z-20 md:hidden bg-[#121212] text-white p-2 border border-[#333]"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button><div id="sidebar" class="w-64 flex flex-col border-r-[3px] border-[#121212] bg-[#F8F8F3] z-10 absolute md:relative h-full transition-transform transform -translate-x-full md:translate-x-0"><div class="p-4 border-b-[3px] border-[#121212] bg-[#121212] text-white"><div class="flex justify-between items-center mb-2"><span class="text-xs font-bold font-mono tracking-widest">ASSETS</span> <span id="assetCount" class="bg-[#FF3366] text-[10px] px-1.5 font-bold">0</span></div><div class="flex gap-2"><button id="addHtml" class="flex-1 bg-[#333] hover:bg-white hover:text-black text-white text-[10px] font-bold py-2 transition-colors uppercase">+HTML</button> <button id="addCss" class="flex-1 bg-[#333] hover:bg-white hover:text-black text-white text-[10px] font-bold py-2 transition-colors uppercase">+CSS</button> <button id="addJs" class="flex-1 bg-[#333] hover:bg-white hover:text-black text-white text-[10px] font-bold py-2 transition-colors uppercase">+JS</button></div><button id="clearProject" class="w-full mt-2 bg-red-900/50 hover:bg-red-600 text-white text-[9px] font-bold py-1 uppercase border border-red-800 transition-colors">Reset Project</button></div><div id="assetList" class="flex-1 overflow-y-auto"></div></div><div class="flex-1 flex flex-col relative bg-[#121212] w-full"><div id="noAssetPrompt" class="absolute inset-0 z-10 bg-[#121212] flex flex-col items-center justify-center p-12 text-center"><div class="w-20 h-20 border-4 border-[#333] flex items-center justify-center mb-6 animate-pulse"><svg class="w-10 h-10 text-[#555]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg></div><h3 class="text-xl font-bold text-[#333] uppercase tracking-widest mb-2">System Ready</h3><p class="text-sm font-mono text-[#555] max-w-xs leading-relaxed">[WAITING FOR INPUT]<br>Drag files anywhere to import.<br>Or use buttons to create new assets.</p></div><div id="editorHeader" class="hidden h-12 bg-[#1e1e1e] border-b border-[#333] flex items-center justify-between px-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div><span id="currentFileName" class="text-sm font-mono text-[#888] ml-4">Select an asset</span></div><button id="removeAsset" class="text-[10px] font-bold text-red-500 hover:text-red-400 border border-red-900 bg-red-900/20 px-3 py-1 uppercase tracking-wider hover:bg-red-500 hover:text-white transition-all">Delete File</button></div><textarea id="mainEditor" class="editor-area hidden flex-1 w-full p-6 text-sm resize-none focus:bg-[#1a1a1a]" spellcheck="false" placeholder="// Write code here..."></textarea><div id="mediaView" class="hidden flex-1 flex flex-col items-center justify-center bg-[#121212] p-10 overflow-hidden relative"><div class="absolute inset-0 opacity-10" style="background-image:linear-gradient(#333 1px,transparent 1px),linear-gradient(90deg,#333 1px,transparent 1px);background-size:20px 20px"></div><div class="relative z-10 text-center"><div class="text-[10px] font-bold text-[#555] mb-4 uppercase tracking-widest border-b border-[#333] inline-block pb-1">Binary Asset Preview</div><div class="border-4 border-[#333] bg-[#000] p-2 inline-block shadow-[8px_8px_0_#333]"><img id="imgPreview" class="max-w-full max-h-[350px] block" src="" alt=""></div><div id="base64Summary" class="mt-4 text-[10px] font-mono text-[#444] break-all max-w-md text-center border border-[#333] p-2 bg-[#1a1a1a]">...</div></div></div><div id="dropOverlay" class="absolute inset-0 pointer-events-none z-50 flex items-center justify-center transition-all duration-200 hidden"><div class="bg-[#F0F0EB] border-[5px] border-[#121212] px-12 py-8 shadow-[12px_12px_0_#000]"><h2 class="text-4xl font-black uppercase tracking-tighter animate-pulse">Drop Files</h2></div></div></div></section><section id="output" class="tab-content hidden p-6 md:p-10 flex flex-col h-full gap-8"><div class="flex flex-wrap items-end gap-6 p-6 bg-[#F8F8F3] border-[3px] border-[#121212] shadow-[6px_6px_0_#121212]"><div class="flex flex-col gap-2"><label class="text-[10px] font-bold uppercase tracking-widest text-[#666]">Build Configuration</label><div class="relative"><select id="mode" class="brutal-input px-4 py-3 text-sm font-bold appearance-none pr-10 cursor-pointer w-64"><option value="inline">Single HTML Bundle (Inline)</option><option value="separate">Multi-file Minification</option></select><div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none font-bold">‚ñº</div></div></div><div class="flex-1"></div><button id="build" class="bg-[#121212] hover:bg-[#FF3366] text-white text-sm font-black py-4 px-12 uppercase tracking-widest shadow-[4px_4px_0_#FF3366] hover:shadow-[6px_6px_0_#FF3366] hover:translate-x-[-2px] hover:translate-y-[-2px] transition-all flex items-center gap-2"><span id="buildIcon">‚ö°</span> Run Build</button><div id="build-status" class="hidden text-[#FF3366] font-bold font-mono text-sm uppercase self-center mb-1 animate-pulse">// OPTIMIZING...</div></div><div id="statsPanel" class="hidden p-4 bg-[#58CC02] text-white font-mono text-xs border-2 border-black shadow-[4px_4px_0_black]"><strong>OPTIMIZATION REPORT:</strong> <span id="statsText">Calculating...</span></div><div class="grid grid-cols-1 lg:grid-cols-3 gap-8 h-full"><div class="lg:col-span-2 space-y-6"><div class="border-[3px] border-[#121212] h-[400px] bg-white shadow-[4px_4px_0_#121212] flex flex-col"><div class="bg-[#121212] text-white px-4 py-2 text-xs font-mono flex justify-between items-center"><span>LIVE PREVIEW</span> <button id="togglePreview" class="hover:text-[#FF3366] transition-colors text-[10px] border border-[#555] px-2 py-0.5">TOGGLE</button></div><div id="previewBox" class="flex-1 overflow-hidden bg-white relative"><iframe id="previewFrame" class="w-full h-full border-none"></iframe></div></div></div><div class="space-y-4"><h3 class="text-xs font-black uppercase border-b-2 border-[#121212] pb-1 mb-4">Output Artifacts</h3><button id="downH" class="w-full group text-left p-4 border-[3px] border-[#121212] bg-white hover:bg-[#121212] hover:text-white transition-all relative"><div class="flex justify-between items-center pr-6"><span class="font-bold font-mono text-sm">index.min.html</span></div><button class="copy-btn absolute right-2 top-2 bottom-2 w-8 flex items-center justify-center bg-[#F0F0EB] border border-black text-[10px] hover:bg-[#FF3366] hover:text-white hover:border-transparent" data-target="html">COPY</button></button> <button id="downC" class="w-full group text-left p-4 border-[3px] border-[#121212] bg-white hover:bg-[#121212] hover:text-white transition-all relative"><div class="flex justify-between items-center pr-6"><span class="font-bold font-mono text-sm">styles.min.css</span></div><button class="copy-btn absolute right-2 top-2 bottom-2 w-8 flex items-center justify-center bg-[#F0F0EB] border border-black text-[10px] hover:bg-[#FF3366] hover:text-white hover:border-transparent" data-target="css">COPY</button></button> <button id="downJ" class="w-full group text-left p-4 border-[3px] border-[#121212] bg-white hover:bg-[#121212] hover:text-white transition-all relative"><div class="flex justify-between items-center pr-6"><span class="font-bold font-mono text-sm">scripts.min.js</span></div><button class="copy-btn absolute right-2 top-2 bottom-2 w-8 flex items-center justify-center bg-[#F0F0EB] border border-black text-[10px] hover:bg-[#FF3366] hover:text-white hover:border-transparent" data-target="js">COPY</button></button><div class="pt-4 border-t border-dashed border-[#121212]"><button id="downA" class="w-full bg-[#FF3366] text-white font-black uppercase text-xs py-4 shadow-[4px_4px_0_#121212] active:translate-x-1 active:translate-y-1 active:shadow-none transition-all">Download Bundle</button></div></div></div></section><section id="log" class="tab-content hidden p-0 h-[600px] flex flex-col bg-[#121212]"><div class="bg-[#222] px-4 py-2 text-xs text-[#888] font-mono border-b border-[#333] flex justify-between"><span>> TERMINAL OUTPUT</span> <span class="text-[#FF3366]">‚óè LIVE</span></div><div id="logBox" class="flex-1 overflow-y-auto p-6 font-mono text-xs md:text-sm leading-relaxed text-[#ccc]"><div class="text-[#555] italic">> System initialized. Waiting for user input...</div></div></section></main></div><div id="usageModalOverlay" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4"><div class="modal-content w-full max-w-3xl max-h-[85vh] flex flex-col"><div class="p-6 border-b-[3px] border-[#121212] bg-[#F8F8F3] flex justify-between items-start"><div><h2 class="text-2xl font-black uppercase tracking-tighter">Image Usage Review</h2><p class="text-xs font-mono text-[#666] mt-1">Detected references in source code.</p></div><div class="w-3 h-3 bg-[#FF3366] rounded-full animate-ping"></div></div><div class="flex-1 overflow-y-auto p-8 space-y-8"><div id="referencedSection"><h3 class="text-[10px] font-bold uppercase tracking-[0.2em] text-[#121212] mb-4 border-l-4 border-[#58CC02] pl-3 bg-green-100 inline-block py-1">Referenced Assets (Keep)</h3><div id="referencedList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div><div id="unreferencedSection"><h3 class="text-[10px] font-bold uppercase tracking-[0.2em] text-[#121212] mb-4 border-l-4 border-[#FF3366] pl-3 bg-red-100 inline-block py-1">Unused Assets (Delete)</h3><div id="unreferencedList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div></div><div class="p-6 border-t-[3px] border-[#121212] bg-[#F8F8F3] flex gap-4"><button id="modalCancel" class="flex-1 py-4 border-[3px] border-[#121212] text-[#121212] text-xs font-bold uppercase hover:bg-[#121212] hover:text-white transition-colors">Cancel</button> <button id="modalProceed" class="flex-1 py-4 bg-[#58CC02] border-[3px] border-[#121212] text-white text-xs font-bold uppercase shadow-[4px-4px-0-#121212] hover:translate-x-[-1px] hover:translate-y-[-1px] hover:shadow-[5px-5px-0-#121212] transition-all">Proceed & Clean</button></div></div></div><script type="module">import{minify as minifyHTML}from"https://esm.sh/html-minifier-terser";import CleanCSS from"https://esm.sh/clean-css";import{minify as minifyJS}from"https://esm.sh/terser";let assets=[],activeAssetId=null,outputs={html:"",css:"",js:""};const STORAGE_KEY="brutal_minifier_v2",logBox=document.getElementById("logBox"),assetList=document.getElementById("assetList"),mainEditor=document.getElementById("mainEditor"),mediaView=document.getElementById("mediaView"),imgPreview=document.getElementById("imgPreview"),base64Summary=document.getElementById("base64Summary"),currentFileName=document.getElementById("currentFileName"),buildStatus=document.getElementById("build-status"),noAssetPrompt=document.getElementById("noAssetPrompt"),editorHeader=document.getElementById("editorHeader"),assetCount=document.getElementById("assetCount"),usageModal=document.getElementById("usageModalOverlay"),refList=document.getElementById("referencedList"),unrefList=document.getElementById("unreferencedList"),sidebar=document.getElementById("sidebar"),statsPanel=document.getElementById("statsPanel"),statsText=document.getElementById("statsText"),log=e=>{1===logBox.children.length&&logBox.querySelector(".italic")&&(logBox.innerHTML="");const t=document.createElement("div");t.className="log-line border-l-2 border-[#333] pl-3 py-1 mb-2 hover:bg-white/5 transition-colors";const s=(new Date).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});t.innerHTML=`<span class="text-[#555] font-mono mr-3">[${s}]</span> ${e}`,logBox.appendChild(t),logBox.scrollTop=logBox.scrollHeight},showToast=(e,t="info")=>{const s=document.getElementById("toast-container"),n=document.createElement("div");n.className="toast";let a="‚ÑπÔ∏è";"success"===t&&(a="‚úÖ"),"error"===t&&(a="‚ö†Ô∏è"),"warning"===t&&(a="üî•"),n.innerHTML=`<span>${e}</span> <span class="text-lg">${a}</span>`,n.style.borderLeftColor="success"===t?"var(--secondary-color)":"error"===t?"var(--accent-color)":"var(--ink-color)",s.appendChild(n),setTimeout(()=>{n.style.animation="fadeOut 0.3s ease-out forwards",setTimeout(()=>n.remove(),300)},3e3)},saveState=()=>{localStorage.setItem(STORAGE_KEY,JSON.stringify(assets))},loadState=()=>{const e=localStorage.getItem(STORAGE_KEY);if(e)try{assets=JSON.parse(e),renderAssetList(),assets.length>0&&showToast("Project restored from local storage","success")}catch(e){console.error("Save file corrupted")}},renderAssetList=()=>{if(assetList.innerHTML="",assetCount.innerText=assets.length,0===assets.length)return noAssetPrompt.classList.remove("hidden"),editorHeader.classList.add("hidden"),mainEditor.classList.add("hidden"),void mediaView.classList.add("hidden");noAssetPrompt.classList.add("hidden"),editorHeader.classList.remove("hidden"),assets.forEach(e=>{const t=document.createElement("div");t.className="asset-item px-4 py-3 cursor-pointer flex justify-between items-center "+(e.id===activeAssetId?"active":"");let s="üìÑ";"css"===e.type&&(s="üé®"),"js"===e.type&&(s="‚ö°"),"media"===e.type&&(s="üñºÔ∏è"),t.innerHTML=`\n                <div class="flex items-center gap-3 overflow-hidden">\n                    <span class="text-lg">${s}</span>\n                    <span class="text-xs font-mono truncate ${e.id===activeAssetId?"text-[#121212]":"text-[#666]"}">${e.name}</span>\n                </div>\n                <span class="text-[9px] border border-[#121212] px-1.5 font-bold uppercase text-[#555]">${e.type}</span>\n            `,t.onclick=()=>selectAsset(e.id),assetList.appendChild(t)})},selectAsset=e=>{if(activeAssetId){const e=assets.find(e=>e.id===activeAssetId);e&&"media"!==e.type&&(e.content=mainEditor.value)}if(!e)return activeAssetId=null,void renderAssetList();activeAssetId=e;const t=assets.find(t=>t.id===e);t&&(currentFileName.innerText=t.name,"media"===t.type?(mainEditor.classList.add("hidden"),mediaView.classList.remove("hidden"),imgPreview.src=t.content,base64Summary.innerText=t.content.substring(0,80)+"... (Length: "+t.content.length+")"):(mainEditor.classList.remove("hidden"),mediaView.classList.add("hidden"),mainEditor.value=t.content),renderAssetList(),saveState(),window.innerWidth<768&&sidebar.classList.add("-translate-x-full"))},addAsset=(e,t,s)=>{const n=crypto.randomUUID();assets.push({id:n,type:e,name:t,content:s}),log(`Successfully imported: <span class="text-[#58CC02] font-bold">${t}</span>`),selectAsset(n),saveState(),showToast(`Added ${t}`,"success")};document.getElementById("addHtml").onclick=()=>addAsset("html",`page-${assets.filter(e=>"html"===e.type).length+1}.html`,"<!DOCTYPE html>\n<html>\n<body>\n  \n</body>\n</html>"),document.getElementById("addCss").onclick=()=>addAsset("css",`style-${assets.filter(e=>"css"===e.type).length+1}.css`,"/* Styles */\n"),document.getElementById("addJs").onclick=()=>addAsset("js",`script-${assets.filter(e=>"js"===e.type).length+1}.js`,"// Script\n"),document.getElementById("removeAsset").onclick=()=>{const e=assets.find(e=>e.id===activeAssetId);e&&log(`Deleted asset: ${e.name}`),assets=assets.filter(e=>e.id!==activeAssetId),assets.length>0?selectAsset(assets[assets.length-1].id):selectAsset(null),saveState()},document.getElementById("clearProject").onclick=()=>{confirm("Are you sure you want to delete all files? This cannot be undone.")&&(assets=[],activeAssetId=null,localStorage.removeItem(STORAGE_KEY),renderAssetList(),log("Project reset."),showToast("Project cleared","error"))},mainEditor.addEventListener("keydown",function(e){if("Tab"==e.key){e.preventDefault();var t=this.selectionStart,s=this.selectionEnd;this.value=this.value.substring(0,t)+"  "+this.value.substring(s),this.selectionStart=this.selectionEnd=t+2;const n=assets.find(e=>e.id===activeAssetId);n&&(n.content=this.value,saveState())}}),document.querySelectorAll(".tab-btn").forEach(e=>{e.onclick=()=>{document.querySelectorAll(".tab-btn").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(e=>e.classList.add("hidden")),e.classList.add("active"),document.getElementById(e.dataset.tab).classList.remove("hidden")}}),document.getElementById("sidebarToggle").onclick=()=>{sidebar.classList.toggle("-translate-x-full")};const dropBoundary=document.getElementById("dropBoundary"),dropOverlay=document.getElementById("dropOverlay");dropBoundary.addEventListener("dragover",e=>{e.preventDefault(),dropOverlay.classList.remove("hidden")}),dropBoundary.addEventListener("dragleave",e=>{null!==e.relatedTarget&&e.relatedTarget!==dropBoundary&&dropBoundary.contains(e.relatedTarget)||dropOverlay.classList.add("hidden")}),dropBoundary.addEventListener("drop",async e=>{e.preventDefault(),dropOverlay.classList.add("hidden");const t=Array.from(e.dataTransfer.files);if(0!==t.length)for(const e of t){const t=e.name.split(".").pop().toLowerCase(),s=e.size/1024/1024;if(["png","jpg","jpeg","gif","svg","webp","ico"].includes(t)){s>.5&&showToast(`Warning: ${e.name} is large and might lag the browser.`,"warning");const t=new FileReader;t.onload=t=>addAsset("media",e.name,t.target.result),t.readAsDataURL(e)}else{const s=await e.text();["html","htm"].includes(t)?addAsset("html",e.name,s):"css"===t?addAsset("css",e.name,s):"js"===t&&addAsset("js",e.name,s)}}});const scanImageUsage=()=>{const e=assets.filter(e=>"media"===e.type),t=assets.filter(e=>"html"===e.type).map(e=>e.content).join(" "),s=assets.filter(e=>"css"===e.type).map(e=>e.content).join(" ");let n=[],a=[];return e.forEach(e=>{const o=e.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),d=new RegExp(`(src|href)=["']([^"']*\\/)?${o}["']`,"i"),i=new RegExp(`url\\(\\s*["']?([^"')]*\\/)?${o}["']?\\s*\\)`,"i");let l=[];d.test(t)&&l.push("HTML"),i.test(s)&&l.push("CSS"),l.length>0?n.push({...e,foundIn:l}):a.push(e)}),{used:n,unused:a}},showUsageModal=(e,t)=>{refList.innerHTML="",unrefList.innerHTML="",e.forEach(e=>{const t=document.createElement("div");t.className="flex items-center gap-4 bg-white border-[3px] border-[#121212] p-3 shadow-[3px-3px-0-#000]",t.innerHTML=`\n                <img src="${e.content}" class="w-12 h-12 object-cover border border-[#333]">\n                <div class="flex-1 min-w-0">\n                    <div class="font-mono text-xs font-bold truncate text-[#121212]">${e.name}</div>\n                    <div class="text-[10px] uppercase text-[#58CC02] font-bold">Found in ${e.foundIn.join(" & ")}</div>\n                </div>\n                <div class="w-2 h-2 bg-[#58CC02] rounded-full"></div>\n            `,refList.appendChild(t)}),t.forEach(e=>{const t=document.createElement("div");t.className="flex items-center gap-4 bg-[#F8F8F3] border-[3px] border-[#ccc] p-3 opacity-70",t.innerHTML=`\n                <img src="${e.content}" class="w-12 h-12 object-cover grayscale border border-[#333]">\n                <div class="flex-1 min-w-0">\n                    <div class="font-mono text-xs font-bold truncate text-[#666]">${e.name}</div>\n                    <div class="text-[10px] uppercase text-[#FF3366] font-bold">Unused</div>\n                </div>\n            `,unrefList.appendChild(t)}),usageModal.classList.remove("hidden")};document.getElementById("modalCancel").onclick=()=>usageModal.classList.add("hidden"),document.getElementById("modalProceed").onclick=()=>{usageModal.classList.add("hidden");const{unused:e}=scanImageUsage();assets=assets.filter(t=>!e.find(e=>e.id===t.id)),renderAssetList(),saveState(),log(`<span class="text-[#FF3366] font-bold">Purged ${e.length} unused media assets.</span>`),showToast(`Removed ${e.length} unused files`,"success"),executeBuild()},document.getElementById("build").onclick=()=>{if(activeAssetId){const e=assets.find(e=>e.id===activeAssetId);e&&"media"!==e.type&&(e.content=mainEditor.value)}const{used:e,unused:t}=scanImageUsage();t.length>0?showUsageModal(e,t):executeBuild()};const executeBuild=async()=>{const e=assets.find(e=>"html"===e.type);if(!e)return log("<span class='text-[#FF3366]'>Error:</span> No HTML entry found.");buildStatus.classList.remove("hidden"),statsPanel.classList.add("hidden"),log("Starting protected build sequence...");const t=document.getElementById("mode").value;let s=e.content,n=assets.filter(e=>"css"===e.type).map(e=>e.content).join("\n"),a=assets.filter(e=>"js"===e.type).map(e=>e.content).join("\n");const o=assets.filter(e=>"media"===e.type);let d=s.length+n.length+a.length+o.reduce((e,t)=>e+t.content.length,0);try{n&&(n=(new CleanCSS).minify(n).styles),a&&(a=(await minifyJS(a)).code),"inline"===t&&o.length>0&&(log(`Inlining ${o.length} assets into HTML/CSS...`),o.forEach(e=>{e.content.length>5e5&&log(`<span class="text-[#FF3366]">Warning: ${e.name} is very large for Base64 inlining.</span>`);const t=e.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=new RegExp(`(['"\\(])(?:[^'"\\(\\)]*?\\/)?${t}(['"\\)])`,"g"),o=(t,s,n)=>`${s}${e.content}${n}`;s=s.replace(a,o),n&&(n=n.replace(a,o))})),"inline"===t&&(n&&(s=s.replace("</head>",`<style>${n}</style></head>`)),a&&(s=s.replace("</body>",`<script>${a}<\/script></body>`))),s=await minifyHTML(s,{collapseWhitespace:!0,removeComments:!0,minifyCSS:!0,minifyJS:!0}),outputs={html:s,css:n,js:a},document.getElementById("previewFrame").srcdoc=s;const e=s.length+("separate"===t?n.length+a.length:0),i=d-e,l=(i/d*100).toFixed(1);statsPanel.classList.remove("hidden"),statsText.innerHTML=`Original: ${formatBytes(d)} ‚Üí Final: ${formatBytes(e)} (Saved ${formatBytes(i)} / ${l}%)`,log("<span class='text-[#58CC02] font-bold'>Build Complete.</span> Outputs generated."),showToast("Build Successful!","success"),document.querySelector('[data-tab="output"]').click()}catch(e){log(`<span class="text-[#FF3366]">Error:</span> ${e.message}`),showToast("Build failed. Check logs.","error")}finally{buildStatus.classList.add("hidden")}},formatBytes=(e,t=2)=>{if(0===e)return"0 Bytes";const s=t<0?0:t,n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(s))+" "+["Bytes","KB","MB","GB"][n]},dl=(e,t)=>{if(!t)return;const s=document.createElement("a");s.href=URL.createObjectURL(new Blob([t],{type:"text/plain"})),s.download=e,s.click(),showToast(`Downloaded ${e}`,"success")},copyToClipboard=(e,t)=>{e&&navigator.clipboard.writeText(e).then(()=>{showToast(`Copied ${t} to clipboard`,"success")})};document.querySelectorAll(".copy-btn").forEach(e=>{e.onclick=t=>{t.stopPropagation();const s=e.dataset.target;copyToClipboard(outputs[s],"html"===s?"HTML":"css"===s?"CSS":"JS")}}),document.getElementById("downH").onclick=()=>dl("index.min.html",outputs.html),document.getElementById("downC").onclick=()=>dl("styles.min.css",outputs.css),document.getElementById("downJ").onclick=()=>dl("scripts.min.js",outputs.js),document.getElementById("downA").onclick=()=>{dl("index.min.html",outputs.html),outputs.css&&dl("styles.min.css",outputs.css),outputs.js&&dl("scripts.min.js",outputs.js)},document.getElementById("togglePreview").onclick=()=>{document.getElementById("previewBox").classList.toggle("hidden")},loadState()</script></body></html>
