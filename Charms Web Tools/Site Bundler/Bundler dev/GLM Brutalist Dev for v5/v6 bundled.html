<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>STATIC ASSET MINIFIER // BRUTALIST EDITION</title><meta name="viewport" content="width=device-width,initial-scale=1"><script src="lib/tailwind.min.js"></script><script src="lib/clean-css.js"></script><script src="lib/html-minifier.js"></script><script src="lib/terser.js"></script><script src="lib/diff.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet"><style>:root{--bg-color:#F0F0EB;--surface-color:#FFFFFF;--ink-color:#121212;--accent-color:#FF3366;--secondary-color:#58CC02;--border-width:3px;--shadow-offset:5px;--radius:0px}body{background-color:var(--bg-color);color:var(--ink-color);font-family:'Space Grotesk',sans-serif;overflow-x:hidden;background-image:radial-gradient(var(--ink-color) 1px,transparent 1px);background-size:20px 20px}.font-mono{font-family:'JetBrains Mono',monospace}.brutal-shadow{box-shadow:var(--shadow-offset) var(--shadow-offset) 0 var(--ink-color);border:var(--border-width) solid var(--ink-color);transition:all .15s cubic-bezier(.25, .46, .45, .94)}.brutal-shadow:hover{transform:translate(-2px,-2px);box-shadow:calc(var(--shadow-offset) + 2px) calc(var(--shadow-offset) + 2px) 0 var(--ink-color)}.brutal-shadow:active{transform:translate(2px,2px);box-shadow:0 0 0 var(--ink-color)}.brutal-input{background:var(--surface-color);border:var(--border-width) solid var(--ink-color);color:var(--ink-color);font-family:'JetBrains Mono',monospace;outline:0;transition:.2s}.brutal-input:focus{background:#fffbeb;border-color:var(--accent-color)}#loadingOverlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(18,18,18,.95);z-index:9999;display:flex;flex-direction:column;justify-content:center;align-items:center;color:#fff;font-family:'JetBrains Mono',monospace;opacity:0;pointer-events:none;transition:opacity .3s ease-in-out}#loadingOverlay.active{opacity:1;pointer-events:auto}.loader-box{width:60px;height:60px;border:5px solid #f36;animation:spin 1s infinite cubic-bezier(.79,.14,.15,.86);margin-bottom:2rem}@keyframes spin{0%{transform:rotate(0)}50%{transform:rotate(180deg);background:#f36}100%{transform:rotate(360deg)}}.loading-text{font-size:1.5rem;font-weight:800;letter-spacing:2px;animation:blink .8s infinite alternate}@keyframes blink{from{opacity:1}to{opacity:.5}}.tab-btn{background:var(--bg-color);border-bottom:var(--border-width) solid transparent;color:#666;font-weight:700;text-transform:uppercase;letter-spacing:1px;position:relative;transition:.2s}.tab-btn.active{color:var(--ink-color);background:var(--surface-color);border-bottom-color:var(--ink-color)}.tab-btn.active::after{content:'';position:absolute;bottom:calc(-1 * var(--border-width) - 4px);left:0;width:100%;height:4px;background:var(--accent-color);z-index:10}.asset-item{border-left:4px solid transparent;background:rgba(255,255,255,.4);border-bottom:1px solid rgba(0,0,0,.1);transition:all .2s}.asset-item:hover .asset-controls{opacity:1}.asset-controls{opacity:0;transition:opacity .2s}.asset-item:hover{background:#fff}.asset-item.active{background:var(--surface-color);border-left-color:var(--accent-color);font-weight:700}.editor-area{background:#1a1a1a;color:#eee;border:none;font-family:'JetBrains Mono',monospace;line-height:1.5;caret-color:var(--accent-color)}#dropOverlay{background-image:repeating-linear-gradient(45deg,var(--accent-color) 0,var(--accent-color) 10px,var(--ink-color) 10px,var(--ink-color) 20px);opacity:.9;transform:scale(.98)}#usageModalOverlay{background:rgba(18,18,18,.8);backdrop-filter:blur(8px)}.modal-content{background:var(--bg-color);border:var(--border-width) solid var(--ink-color);box-shadow:10px 10px 0 var(--ink-color)}@keyframes marquee{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}.animate-marquee{white-space:nowrap;overflow:hidden;display:inline-block}.animate-marquee span{display:inline-block;animation:marquee 20s linear infinite}::-webkit-scrollbar{width:10px;height:10px}::-webkit-scrollbar-track{background:var(--bg-color);border-left:1px solid var(--ink-color)}::-webkit-scrollbar-thumb{background:var(--ink-color);border:2px solid var(--bg-color)}::-webkit-scrollbar-thumb:hover{background:var(--accent-color)}*{cursor:none!important}#cursor{position:fixed;top:0;left:0;width:25px;height:25px;background:#fff;mix-blend-mode:difference;transform:translate3d(-50%,-50%,0);pointer-events:none;z-index:10001;transition:width .2s cubic-bezier(.16, 1, .3, 1),height .2s cubic-bezier(.16, 1, .3, 1);display:block!important;visibility:visible!important;opacity:1!important}#cursor.hovered{width:50px;height:50px}</style></head><body class="min-h-screen flex flex-col" id="dropBoundary"><div id="cursor"></div><header class="p-6 md:p-8 border-b-[3px] border-[#121212] bg-[#F0F0EB]"><div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-start md:items-end gap-4"><div><div class="flex items-center gap-4 mb-2"><div class="bg-[#121212] text-[#F0F0EB] px-2 py-1 text-xs font-bold font-mono uppercase tracking-widest">v2.1.0</div><div class="h-[2px] flex-1 bg-[#121212]"></div></div><h1 class="text-4xl md:text-6xl font-bold uppercase tracking-tighter leading-none">Static Asset<br><span class="text-[#FF3366]">Minifier</span> & Bundler</h1></div><div class="max-w-xs flex flex-col items-end gap-2"><div class="flex gap-2"><button id="importProjectBtn" class="bg-[#121212] text-white text-[10px] font-bold uppercase tracking-widest px-3 py-2 hover:bg-[#58CC02] transition-colors flex items-center gap-2" title="Import Project JSON"><span>üìÇ</span> OPEN</button> <button id="exportProjectBtn" class="bg-[#121212] text-white text-[10px] font-bold uppercase tracking-widest px-3 py-2 hover:bg-[#FF3366] transition-colors flex items-center gap-2" title="Export Project JSON"><span>üíæ</span> SAVE</button> <input type="file" id="projectInput" accept=".json" class="hidden"></div><button id="openHelp" class="text-[10px] font-bold uppercase tracking-widest border-[2px] border-[#121212] px-3 py-1 hover:bg-[#121212] hover:text-white transition-all">[?] HOW TO USE</button></div></div></header><div class="flex-1 max-w-7xl mx-auto w-full p-4 md:p-6 flex flex-col gap-6"><nav class="flex w-full"><button class="tab-btn active flex-1 py-4 text-sm md:text-base border-r-[3px] border-[#121212] border-t-[3px] border-l-[3px] rounded-t-md" data-tab="workspace">Workspace</button> <button class="tab-btn flex-1 py-4 text-sm md:text-base border-r-[3px] border-[#121212] border-t-[3px] rounded-t-md" data-tab="output">Build Output</button> <button class="tab-btn flex-1 py-4 text-sm md:text-base border-r-[3px] border-[#121212] border-t-[3px] rounded-t-md" data-tab="extractor">Extract Output</button> <button class="tab-btn flex-1 py-4 text-sm md:text-base border-t-[3px] border-r-[3px] border-l-[3px] border-[#121212] rounded-t-md" data-tab="log">Process Logs</button></nav><main class="brutal-shadow bg-white relative min-h-[600px] flex flex-col"><section id="workspace" class="tab-content block h-[600px] flex overflow-hidden"><div class="w-64 flex flex-col border-r-[3px] border-[#121212] bg-[#F8F8F3] z-10"><div class="p-4 border-b-[3px] border-[#121212] bg-[#121212] text-white"><div class="flex justify-between items-center mb-2"><span class="text-xs font-bold font-mono tracking-widest">ASSETS</span> <span id="assetCount" class="bg-[#FF3366] text-[10px] px-1.5 font-bold">0</span></div><div class="flex gap-2"><button id="addHtml" class="flex-1 bg-[#333] hover:bg-white hover:text-black text-white text-[10px] font-bold py-2 transition-colors uppercase">+HTML</button> <button id="addCss" class="flex-1 bg-[#333] hover:bg-white hover:text-black text-white text-[10px] font-bold py-2 transition-colors uppercase">+CSS</button> <button id="addJs" class="flex-1 bg-[#333] hover:bg-white hover:text-black text-white text-[10px] font-bold py-2 transition-colors uppercase">+JS</button></div></div><div id="assetList" class="flex-1 overflow-y-auto"></div></div><div class="flex-1 flex flex-col relative bg-[#121212]"><div id="noAssetPrompt" class="absolute inset-0 z-10 bg-[#121212] flex flex-col items-center justify-center p-12 text-center"><div class="w-20 h-20 border-4 border-[#333] flex items-center justify-center mb-6 animate-pulse"><svg class="w-10 h-10 text-[#555]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg></div><h3 class="text-xl font-bold text-[#333] uppercase tracking-widest mb-2">System Ready</h3><p class="text-sm font-mono text-[#555] max-w-xs leading-relaxed">[WAITING FOR INPUT]<br>Drag files anywhere to import.<br>Or use buttons to create new assets.</p></div><div id="editorHeader" class="hidden h-12 bg-[#1e1e1e] border-b border-[#333] flex items-center justify-between px-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div><span id="currentFileName" class="text-sm font-mono text-[#888] ml-4">Select an asset</span></div><button id="removeAsset" class="text-[10px] font-bold text-red-500 hover:text-red-400 border border-red-900 bg-red-900/20 px-3 py-1 uppercase tracking-wider hover:bg-red-500 hover:text-white transition-all">Delete File</button></div><textarea id="mainEditor" class="editor-area hidden flex-1 w-full p-6 text-sm resize-none focus:bg-[#1a1a1a]" placeholder="// Write code here..."></textarea><div id="mediaView" class="hidden flex-1 flex flex-col items-center justify-center bg-[#121212] p-10 overflow-hidden relative"><div class="absolute inset-0 opacity-10" style="background-image:linear-gradient(#333 1px,transparent 1px),linear-gradient(90deg,#333 1px,transparent 1px);background-size:20px 20px"></div><div class="relative z-10 text-center"><div class="text-[10px] font-bold text-[#555] mb-4 uppercase tracking-widest border-b border-[#333] inline-block pb-1">Binary Asset Preview</div><div class="border-4 border-[#333] bg-[#000] p-2 inline-block shadow-[8px_8px_0_#333]"><img id="imgPreview" class="max-w-full max-h-[350px] block" src="" alt=""></div><div id="base64Summary" class="mt-4 text-[10px] font-mono text-[#444] break-all max-w-md text-center border border-[#333] p-2 bg-[#1a1a1a]">...</div></div></div><div id="dropOverlay" class="absolute inset-0 pointer-events-none z-50 flex items-center justify-center transition-all duration-200 hidden"><div class="bg-[#F0F0EB] border-[5px] border-[#121212] px-12 py-8 shadow-[12px_12px_0_#000]"><h2 class="text-4xl font-black uppercase tracking-tighter animate-pulse">Drop Files</h2></div></div></div></section><section id="output" class="tab-content hidden p-6 md:p-10 flex flex-col h-full gap-8"><div class="flex flex-col gap-6 p-6 bg-[#F8F8F3] border-[3px] border-[#121212] shadow-[6px_6px_0_#121212]"><div class="flex flex-wrap items-end justify-between gap-4"><div class="flex flex-col gap-2"><label class="text-[10px] font-bold uppercase tracking-widest text-[#666]">Build Mode</label><div class="relative"><select id="mode" class="brutal-input px-4 py-3 text-sm font-bold appearance-none pr-10 cursor-pointer w-64"><option value="inline">Single HTML Bundle (Inline)</option><option value="bundle">Bundle (Combine by Type)</option><option value="batch">Batch (Minify Individual Files)</option></select><div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none font-bold">‚ñº</div></div></div><div class="flex items-center gap-4"><div id="build-status" class="hidden text-[#FF3366] font-bold font-mono text-sm uppercase animate-pulse">// OPTIMIZING...</div><button id="build" class="bg-[#121212] hover:bg-[#FF3366] text-white text-sm font-black py-4 px-12 uppercase tracking-widest shadow-[4px_4px_0_#FF3366] hover:shadow-[6px_6px_0_#FF3366] hover:translate-x-[-2px] hover:translate-y-[-2px] transition-all flex items-center gap-2"><span id="buildIcon">‚ö°</span> Run Build</button></div></div><div class="pt-4 border-t border-[#ccc] grid grid-cols-1 md:grid-cols-2 gap-6"><div class="flex flex-col gap-3"><label class="text-[10px] font-bold uppercase tracking-widest text-[#666]">Minification Strategy</label><div class="flex flex-col gap-2"><div class="flex items-center gap-4 flex-wrap"><label class="flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="optMinifyHTML" checked="checked" class="w-4 h-4 accent-[#FF3366]"> <span class="text-xs font-mono font-bold">HTML</span></label> <label class="flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="optMinifyCSS" checked="checked" class="w-4 h-4 accent-[#FF3366]"> <span class="text-xs font-mono font-bold">CSS</span></label> <label class="flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="optMinifyJS" checked="checked" class="w-4 h-4 accent-[#FF3366]"> <span class="text-xs font-mono font-bold">JS</span></label></div><div class="flex items-center gap-4 mt-1 border-t border-[#ddd] pt-2"><label class="flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="optComments" checked="checked" class="w-4 h-4 accent-[#FF3366]"> <span class="text-[10px] font-mono font-bold text-[#555]">Remove Comments</span></label> <label class="flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="optConsole" checked="checked" class="w-4 h-4 accent-[#FF3366]"> <span class="text-[10px] font-mono font-bold text-[#555]">Drop Console</span></label></div></div><div class="mt-2 pt-2 border-t border-[#ccc]"><label class="flex items-center gap-2 cursor-pointer select-none opacity-50" id="cdnToggleContainer" title="Checking connectivity..."><input type="checkbox" id="optCDN" class="w-4 h-4 accent-[#58CC02]" disabled="disabled"> <span class="text-xs font-mono font-bold text-[#58CC02]">USE CDN LIBS (vLatest)</span></label><div id="cdnStatus" class="text-[9px] text-[#888] font-mono mt-0.5">Checking internet...</div></div></div><div class="flex flex-col gap-3"><label class="text-[10px] font-bold uppercase tracking-widest text-[#666]">Change Target Filenames</label><div class="flex gap-2"><input id="outNameH" class="brutal-input p-2 text-xs w-full" placeholder="index.min.html" value="index.min.html"> <input id="outNameC" class="brutal-input p-2 text-xs w-full" placeholder="styles.min.css" value="styles.min.css"> <input id="outNameJ" class="brutal-input p-2 text-xs w-full" placeholder="scripts.min.js" value="scripts.min.js"></div></div></div></div><div class="grid grid-cols-1 lg:grid-cols-3 gap-8 h-full"><div class="lg:col-span-2 space-y-6"><div class="border-[3px] border-[#121212] h-[400px] bg-white shadow-[4px_4px_0_#121212] flex flex-col"><div class="bg-[#121212] text-white px-4 py-2 text-xs font-mono flex justify-between items-center"><span>LIVE PREVIEW</span><div class="flex items-center gap-2"><button id="openNewTab" class="hover:text-[#58CC02] transition-colors text-[10px] border border-[#555] px-2 py-0.5">NEW TAB</button> <button id="togglePreview" class="hover:text-[#FF3366] transition-colors text-[10px] border border-[#555] px-2 py-0.5">TOGGLE PREVIEW</button></div></div><div id="previewBox" class="flex-1 overflow-hidden bg-white relative"><iframe id="previewFrame" class="w-full h-full border-none"></iframe></div></div></div><div class="space-y-4"><h3 class="text-xs font-black uppercase border-b-2 border-[#121212] pb-1 mb-4">Output Artifacts</h3><button id="downH" class="w-full group text-left p-4 border-[3px] border-[#121212] bg-white hover:bg-[#121212] hover:text-white transition-all hidden"><div class="flex justify-between items-center"><span id="lblH" class="font-bold font-mono text-sm">index.min.html</span> <span class="text-xs opacity-0 group-hover:opacity-100 transition-opacity">‚Üì</span></div></button> <button id="downC" class="w-full group text-left p-4 border-[3px] border-[#121212] bg-white hover:bg-[#121212] hover:text-white transition-all hidden"><div class="flex justify-between items-center"><span id="lblC" class="font-bold font-mono text-sm">styles.min.css</span> <span class="text-xs opacity-0 group-hover:opacity-100 transition-opacity">‚Üì</span></div></button> <button id="downJ" class="w-full group text-left p-4 border-[3px] border-[#121212] bg-white hover:bg-[#121212] hover:text-white transition-all hidden"><div class="flex justify-between items-center"><span id="lblJ" class="font-bold font-mono text-sm">scripts.min.js</span> <span class="text-xs opacity-0 group-hover:opacity-100 transition-opacity">‚Üì</span></div></button><div class="pt-4 border-t border-dashed border-[#121212]"><label id="zipToggleLabel" class="flex items-center gap-2 cursor-pointer select-none mb-3"><input type="checkbox" id="optZip" checked="checked" class="w-4 h-4 accent-[#FF3366]"> <span class="text-xs font-mono font-bold">Download as ZIP</span></label> <button id="downA" class="w-full bg-[#FF3366] text-white font-black uppercase text-xs py-4 shadow-[4px_4px_0_#121212] active:translate-x-1 active:translate-y-1 active:shadow-none transition-all">Download Bundle</button></div></div></div><div id="diffContainer" class="border-[3px] border-[#121212] bg-white shadow-[4px_4px_0_#121212] flex flex-col mt-6 w-[95vw] relative left-1/2 -translate-x-1/2"><div class="bg-[#121212] text-white px-4 py-2 text-xs font-mono flex justify-between items-center"><div class="flex items-center gap-2"><span>CODE DIFFERENCE</span><div class="flex ml-4 border border-[#555]"><button id="diffTabHtml" class="diff-tab px-3 py-1 text-[10px] font-bold bg-[#333] hover:bg-[#FF3366] transition-colors active" data-type="html">HTML</button> <button id="diffTabCss" class="diff-tab px-3 py-1 text-[10px] font-bold bg-[#222] hover:bg-[#FF3366] transition-colors border-l border-[#555]" data-type="css">CSS</button> <button id="diffTabJs" class="diff-tab px-3 py-1 text-[10px] font-bold bg-[#222] hover:bg-[#FF3366] transition-colors border-l border-[#555]" data-type="js">JS</button> <button id="diffTabBundle" class="diff-tab px-3 py-1 text-[10px] font-bold bg-[#222] hover:bg-[#FF3366] transition-colors border-l border-[#555]" data-type="bundle">FULL</button></div></div><div class="flex items-center gap-3"><label class="flex items-center gap-1 cursor-pointer select-none"><input type="checkbox" id="diffCollapseBase64" checked="checked" class="w-3 h-3 accent-[#FF3366]"> <span class="text-[10px]">COLLAPSE BASE64</span></label> <label class="flex items-center gap-1 cursor-pointer select-none"><input type="checkbox" id="diffWrap" checked="checked" class="w-3 h-3 accent-[#FF3366]"> <span class="text-[10px]">WRAP TEXT</span></label></div></div><div class="flex-1 flex flex-col md:flex-row h-[600px] border-t border-[#333]"><div class="flex-1 min-w-0 flex flex-col border-b md:border-b-0 md:border-r border-[#333]"><div id="diffOriginalLabel" class="bg-[#eee] px-2 py-1 text-[10px] font-bold text-[#555] uppercase border-b border-[#ccc]">Original HTML</div><pre id="diffOriginal" class="flex-1 p-4 font-mono text-xs overflow-auto text-[#444] leading-relaxed whitespace-pre-wrap"></pre></div><div class="flex-1 min-w-0 flex flex-col"><div id="diffOutputLabel" class="bg-[#eee] px-2 py-1 text-[10px] font-bold text-[#555] uppercase border-b border-[#ccc]">Build Output HTML</div><pre id="diffOutput" class="flex-1 p-4 font-mono text-xs overflow-auto text-[#444] leading-relaxed whitespace-pre-wrap"></pre></div></div></div></section><section id="extractor" class="tab-content hidden p-6 md:p-10 flex flex-col h-[600px] gap-6 bg-[#F8F8F3]"><div class="flex flex-col gap-6 p-6 border-[3px] border-[#121212] shadow-[6px_6px_0_#121212] bg-white"><div class="flex flex-col md:flex-row gap-6 items-end justify-between"><div class="flex-1 w-full relative"><label class="text-[10px] font-bold uppercase tracking-widest text-[#666] mb-2 block">Source Code Upload</label><div class="relative"><input type="file" id="extractorInput" accept=".html,.htm" class="hidden"> <button id="extractorUploadBtn" class="w-full bg-[#121212] hover:bg-[#FF3366] text-white text-sm font-black py-4 px-6 uppercase tracking-widest transition-colors flex justify-center items-center gap-2 text-center border-none cursor-pointer shadow-[4px_4px_0_#FF3366] hover:shadow-[6px_6px_0_#FF3366] hover:translate-x-[-2px] hover:translate-y-[-2px]"><span>üìÇ</span> SELECT HTML FILE TO EXTRACT</button></div></div><div class="flex flex-col gap-2 w-full md:w-auto h-full justify-end"><label class="flex items-center gap-2 cursor-pointer select-none p-2 py-4"><input type="checkbox" id="extBase64Dec" checked="checked" class="w-4 h-4 accent-[#FF3366]"> <span class="text-xs font-mono font-bold">DECODE BASE64 IMAGES</span></label></div></div></div><div class="flex-1 flex flex-col border-[3px] border-[#121212] bg-white shadow-[4px_4px_0_#121212] overflow-hidden"><div class="bg-[#121212] text-white px-4 py-2 text-xs font-mono flex justify-between items-center"><span>EXTRACTED ASSETS</span> <button id="extractorDownloadAll" disabled="disabled" class="bg-[#58CC02] hover:bg-white hover:text-black text-black text-[10px] px-3 py-1 font-bold transition-colors uppercase disabled:opacity-50 disabled:cursor-not-allowed hidden">DOWNLOAD ALL (ZIP)</button></div><div id="extractorList" class="flex-1 overflow-y-auto p-4 flex flex-col gap-2 bg-[#F0F0EB]"><div class="text-center text-[#888] font-mono text-xs italic mt-8" id="extractorEmptyState">No file uploaded yet.</div></div></div></section><section id="log" class="tab-content hidden p-0 h-[600px] flex flex-col bg-[#121212]"><div class="bg-[#222] px-4 py-2 text-xs text-[#888] font-mono border-b border-[#333] flex justify-between"><span>> TERMINAL OUTPUT</span> <span class="text-[#FF3366]">‚óè LIVE</span></div><div id="logBox" class="flex-1 overflow-y-auto p-6 font-mono text-xs md:text-sm leading-relaxed text-[#ccc]"><div class="text-[#555] italic">> System initialized. Waiting for user input...</div></div></section></main></div><div id="usageModalOverlay" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4"><div class="modal-content w-full max-w-3xl max-h-[85vh] flex flex-col"><div class="p-6 border-b-[3px] border-[#121212] bg-[#F8F8F3] flex justify-between items-start"><div><h2 class="text-2xl font-black uppercase tracking-tighter">Image Usage Review</h2><p class="text-xs font-mono text-[#666] mt-1">Detected references in source code.</p></div><div class="w-3 h-3 bg-[#FF3366] rounded-full animate-ping"></div></div><div class="flex-1 overflow-y-auto p-8 space-y-8"><div id="referencedSection"><h3 class="text-[10px] font-bold uppercase tracking-[0.2em] text-[#121212] mb-4 border-l-4 border-[#58CC02] pl-3 bg-green-100 inline-block py-1">Referenced Assets (Keep)</h3><div id="referencedList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div><div id="unreferencedSection"><h3 class="text-[10px] font-bold uppercase tracking-[0.2em] text-[#121212] mb-4 border-l-4 border-[#FF3366] pl-3 bg-red-100 inline-block py-1">Unused Assets (Exclude from Bundle)</h3><div id="unreferencedList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div></div><div class="p-6 border-t-[3px] border-[#121212] bg-[#F8F8F3] flex gap-4"><button id="modalCancel" class="flex-1 py-4 border-[3px] border-[#121212] text-[#121212] text-xs font-bold uppercase hover:bg-[#121212] hover:text-white transition-colors">Cancel</button> <button id="modalProceed" class="flex-1 py-4 bg-[#58CC02] border-[3px] border-[#121212] text-white text-xs font-bold uppercase shadow-[4px_4px_0_#121212] hover:translate-x-[-1px] hover:translate-y-[-1px] hover:shadow-[5px_5px_0_#121212] transition-all">Proceed & Build</button></div></div></div><div id="helpModalOverlay" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4"><div class="modal-content w-full max-w-2xl max-h-[85vh] flex flex-col"><div class="p-6 border-b-[3px] border-[#121212] bg-[#F8F8F3] flex justify-between items-start"><h2 class="text-2xl font-black uppercase tracking-tighter">System Manual</h2><button id="closeHelp" class="text-xl font-bold hover:text-[#FF3366]">‚úï</button></div><div class="p-8 overflow-y-auto space-y-6 font-mono text-sm"><div><h3 class="font-bold text-[#FF3366] uppercase mb-2">> 1. Asset Order Matters</h3><p class="text-[#555]">Files are processed in the order shown in the Workspace list.<br>- <strong>CSS:</strong> Lower files can override earlier ones.<br>- <strong>JS:</strong> Dependencies must appear <em>before</em> the scripts that use them.<br>Use the <span class="bg-[#121212] text-white px-1 text-xs">‚Üë</span> <span class="bg-[#121212] text-white px-1 text-xs">‚Üì</span> arrows to reorder.</p></div><div><h3 class="font-bold text-[#FF3366] uppercase mb-2">> 2. Entry Point</h3><p class="text-[#555]">The <strong>FIRST</strong> HTML file in the list is treated as the "Entry Point".<br>All other content (CSS, JS, inlined images) is injected into this file.</p></div><div><h3 class="font-bold text-[#FF3366] uppercase mb-2">> 3. Protected Build</h3><p class="text-[#555]">Unused images are detected automatically. You will be asked to confirm their deletion before building to keep bundle size small.<br><strong>Note:</strong> JS minification is performed safely without mutating variable names that might reference DOM elements.</p></div></div></div></div><div id="loadingOverlay"><div class="loader-box"></div><div class="loading-text">PROCESSING...</div><div id="loadingSubtext" class="text-sm text-gray-400 mt-2 font-mono hidden"></div></div><script>var tailwind=window.tailwind||null,HTMLMinifier=window.HTMLMinifier||null,minifyHTML=HTMLMinifier&&HTMLMinifier.minify?HTMLMinifier.minify:function(e){return e},CleanCSS=window.CleanCSS||function(){return{minify:function(e){return{styles:e}}}},Terser=window.Terser||null,minifyJS=Terser&&Terser.minify?Terser.minify:null,Diff=window.Diff||null;let cdnAvailable=!1;const cdnToggle=document.getElementById("optCDN"),cdnContainer=document.getElementById("cdnToggleContainer"),cdnStatus=document.getElementById("cdnStatus"),checkConnectivity=async()=>{try{const e=new AbortController,t=setTimeout((()=>e.abort()),2e3);await fetch(`https://esm.sh/clean-css?t=${Date.now()}`,{method:"HEAD",signal:e.signal}),clearTimeout(t),cdnAvailable=!0,cdnToggle.disabled=!1,cdnContainer.classList.remove("opacity-50"),cdnContainer.title="Switch to CDN versions",cdnStatus.innerText="Online. CDN Available.",cdnStatus.classList.add("text-[#58CC02]"),cdnStatus.classList.remove("text-[#888]")}catch(e){cdnAvailable=!1,cdnToggle.disabled=!0,cdnToggle.checked=!1,cdnContainer.classList.add("opacity-50"),cdnContainer.title="Offline or CDN Unreachable",cdnStatus.innerText="Offline / CDN Unreachable"}};window.addEventListener("load",checkConnectivity);let cachedCDNLibs=null,isFetchingCDN=!1;const resolveLibraries=async()=>{if(!cdnToggle.checked)return{CleanCSS:window.CleanCSS,minifyHTML:window.HTMLMinifier&&window.HTMLMinifier.minify?window.HTMLMinifier.minify:null,minifyJS:window.Terser&&window.Terser.minify?window.Terser.minify:null};if(cachedCDNLibs)return log("Using cached CDN libraries."),cachedCDNLibs;if(isFetchingCDN){for(log("Waiting for ongoing CDN download...");isFetchingCDN;)await new Promise((e=>setTimeout(e,100)));return cachedCDNLibs}isFetchingCDN=!0,log("Initializing CDN download (Network Forced)...");const e=Date.now(),t=async(t,n)=>{const s=`${t}?v=${e}`;log(`Fetching ${n}...`);try{const e=import(s),t=new Promise(((e,t)=>setTimeout((()=>t(new Error(`Timeout fetching ${n}`))),15e3)));return await Promise.race([e,t])}catch(e){throw new Error(`Failed to load ${n}: ${e.message}`)}};try{const[e,n,s]=await Promise.all([t("https://esm.sh/clean-css","CleanCSS"),t("https://esm.sh/html-minifier-terser","HTMLMinifier"),t("https://esm.sh/terser","Terser")]);return log("All CDN libraries loaded successfully."),cachedCDNLibs={CleanCSS:e.default,minifyHTML:n.minify,minifyJS:s.minify},isFetchingCDN=!1,cachedCDNLibs}catch(e){throw isFetchingCDN=!1,e}};let assets=[],activeAssetId=null,outputs={html:"",css:"",js:""},originals={html:"",css:"",js:""},finals={html:"",css:"",js:""},batchFiles=[],currentDiffTab="html",cachedCleanCSSInstance=null;const assetSizeCache=new Map,logBox=document.getElementById("logBox"),assetList=document.getElementById("assetList"),mainEditor=document.getElementById("mainEditor"),mediaView=document.getElementById("mediaView"),imgPreview=document.getElementById("imgPreview"),base64Summary=document.getElementById("base64Summary"),currentFileName=document.getElementById("currentFileName"),buildStatus=document.getElementById("build-status"),noAssetPrompt=document.getElementById("noAssetPrompt"),editorHeader=document.getElementById("editorHeader"),assetCount=document.getElementById("assetCount"),usageModal=document.getElementById("usageModalOverlay"),refList=document.getElementById("referencedList"),unrefList=document.getElementById("unreferencedList"),modalProceed=document.getElementById("modalProceed"),modalCancel=document.getElementById("modalCancel"),log=e=>{1===logBox.children.length&&logBox.querySelector(".italic")&&(logBox.innerHTML="");const t=document.createElement("div");t.className="log-line border-l-2 border-[#333] pl-3 py-1 mb-2 hover:bg-white/5 transition-colors";const n=(new Date).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});t.innerHTML=`<span class="text-[#555] font-mono mr-3">[${n}]</span> ${e}`,logBox.appendChild(t),logBox.scrollTop=logBox.scrollHeight},formatBytes=(e,t=1)=>{if(!+e)return"0 B";const n=t<0?0:t,s=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,s)).toFixed(n))} ${["B","KB","MB","GB"][s]}`},checkModeAvailability=()=>{const e=assets.some((e=>"html"===e.type)),t=document.getElementById("mode"),n=t.querySelector('option[value="inline"]');!e&&assets.length>0?(n&&(n.disabled=!0,n.textContent="Single HTML Bundle (Requires HTML File)"),"inline"===t.value&&(t.value="bundle",updateZipToggleState(),showToast("Switched to Bundle mode (No HTML)","info"))):e&&n&&(n.disabled=!1,n.textContent="Single HTML Bundle (Inline)")},renderAssetList=()=>{if(assetCount.innerText=assets.length,checkModeAvailability(),0===assets.length)return assetList.innerHTML="",noAssetPrompt.classList.remove("hidden"),editorHeader.classList.add("hidden"),mainEditor.classList.add("hidden"),void mediaView.classList.add("hidden");noAssetPrompt.classList.add("hidden"),editorHeader.classList.remove("hidden");const e=assets.find((e=>"html"===e.type))?.id,t=document.createDocumentFragment();assets.forEach(((n,s)=>{const o=document.createElement("div");let i;o.className="asset-item px-4 py-3 cursor-pointer flex justify-between items-center group relative "+(n.id===activeAssetId?"active":""),assetSizeCache.has(n.id)?i=assetSizeCache.get(n.id):(i="media"===n.type?.75*n.content.length:new Blob([n.content]).size,assetSizeCache.set(n.id,i));const a=formatBytes(i);let l="üìÑ";"css"===n.type&&(l="üé®"),"js"===n.type&&(l="‚ö°"),"media"===n.type&&(l="üñºÔ∏è");const c=n.id===e;o.innerHTML=`\n          <div class="flex items-center gap-3 overflow-hidden flex-1" onclick="selectAsset('${n.id}')">\n            <span class="text-lg">${l}</span>\n            <div class="min-w-0 flex-1">\n              <div class="flex items-center gap-2">\n                <span class="text-xs font-mono font-bold truncate ${n.id===activeAssetId?"text-[#121212]":"text-[#666]"} group-hover:text-[#121212] transition-colors">${n.name}</span>\n                ${c?'<span class="text-[8px] bg-[#121212] text-white px-1 font-bold uppercase tracking-wider">ENTRY</span>':""}\n              </div>\n              <span class="text-[9px] text-[#888] font-mono">${a} ‚Ä¢ ${n.type.toUpperCase()}</span>\n            </div>\n          </div>\n          \n          <div class="asset-controls flex items-center gap-1 pl-2">\n             <button onclick="moveAsset('${n.id}', -1)" class="p-1 hover:bg-[#121212] hover:text-white rounded text-[#555] transition-colors" title="Move Up">‚Üë</button>\n             <button onclick="moveAsset('${n.id}', 1)" class="p-1 hover:bg-[#121212] hover:text-white rounded text-[#555] transition-colors" title="Move Down">‚Üì</button>\n             <button onclick="duplicateAsset('${n.id}')" class="p-1 hover:bg-[#121212] hover:text-white rounded text-[#555] transition-colors" title="Duplicate">‚ùê</button>\n             <button onclick="renameAsset('${n.id}')" class="p-1 hover:bg-[#121212] hover:text-white rounded text-[#555] transition-colors" title="Rename">‚úé</button>\n          </div>\n        `,t.appendChild(o)})),assetList.innerHTML="",assetList.appendChild(t)},showToast=(e,t="info")=>{const n=document.createElement("div"),s="error"===t?"#FF3366":"#58CC02";n.className=`fixed bottom-8 right-8 bg-[#121212] text-white px-6 py-4 font-bold uppercase tracking-wider shadow-[4px_4px_0_${s}] transition-all duration-300 transform translate-y-20 opacity-0 z-[200] border-l-4 border-[${s}]`,n.innerHTML=`<span style="color:${s}">></span> ${e}`,document.body.appendChild(n),requestAnimationFrame((()=>{n.classList.remove("translate-y-20","opacity-0")})),setTimeout((()=>{n.classList.add("translate-y-20","opacity-0"),setTimeout((()=>n.remove()),300)}),3e3)};window.selectAsset=e=>{if(!e)return activeAssetId=null,void renderAssetList();const t=assets.find((e=>e.id===activeAssetId));t&&"media"!==t.type&&(t.content=mainEditor.value),activeAssetId=e;const n=assets.find((t=>t.id===e));n&&(currentFileName.innerText=n.name,"media"===n.type?(mainEditor.classList.add("hidden"),mediaView.classList.remove("hidden"),imgPreview.src=n.content,base64Summary.innerText=n.content.substring(0,80)+"..."):(mainEditor.classList.remove("hidden"),mediaView.classList.add("hidden"),mainEditor.value=n.content),renderAssetList())},window.moveAsset=(e,t)=>{const n=assets.findIndex((t=>t.id===e));if(n<0)return;const s=n+t;s<0||s>=assets.length||([assets[n],assets[s]]=[assets[s],assets[n]],renderAssetList())},window.renameAsset=e=>{const t=assets.find((t=>t.id===e));if(!t)return;const n=prompt("Rename asset:",t.name);n&&""!==n.trim()&&(t.name=n.trim(),activeAssetId===e&&(currentFileName.innerText=t.name),renderAssetList())},window.duplicateAsset=e=>{const t=assets.find((t=>t.id===e));if(!t)return;const n=crypto.randomUUID(),s=t.name.replace(/(\.[^.]*)?$/," (Copy)$1");assets.push({id:n,type:t.type,name:s,content:t.content}),log(`Duplicated: ${t.name} -> ${s}`),showToast("Asset Duplicated"),selectAsset(n)},document.getElementById("exportProjectBtn").onclick=()=>{const e=assets.find((e=>e.id===activeAssetId));e&&"media"!==e.type&&(e.content=mainEditor.value);const t=JSON.stringify(assets),n=new Blob([t],{type:"application/json"}),s=URL.createObjectURL(n),o=document.createElement("a");o.href=s,o.download=`bundler-project-${(new Date).toISOString().slice(0,10)}.json`,o.click(),URL.revokeObjectURL(s),log("Project exported successfully."),showToast("Project Saved")},document.getElementById("importProjectBtn").onclick=()=>{document.getElementById("projectInput").click()},document.getElementById("projectInput").onchange=e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=e=>{try{const t=JSON.parse(e.target.result);if(!Array.isArray(t))throw new Error("Invalid project file format");assets=t,activeAssetId=null,log("Project imported successfully."),showToast("Project Loaded","success"),assets.length>0?selectAsset(assets[0].id):renderAssetList()}catch(e){log(`<span class="text-[#FF3366]">Import Error:</span> ${e.message}`),showToast("Load Failed: Invalid File","error")}},n.readAsText(t),e.target.value=""};const addAsset=(e,t,n)=>{const s=crypto.randomUUID();assets.push({id:s,type:e,name:t,content:n}),log(`Imported: <span class="text-[#58CC02] font-bold">${t}</span>`),selectAsset(s)},helpModal=document.getElementById("helpModalOverlay");document.getElementById("openHelp").onclick=()=>helpModal.classList.remove("hidden"),document.getElementById("closeHelp").onclick=()=>helpModal.classList.add("hidden"),helpModal.onclick=e=>{e.target===helpModal&&helpModal.classList.add("hidden")},document.getElementById("addHtml").onclick=()=>addAsset("html",`page-${assets.filter((e=>"html"===e.type)).length+1}.html`,"<!DOCTYPE html>\n<html>\n<body>\n  \n</body>\n</html>"),document.getElementById("addCss").onclick=()=>addAsset("css",`style-${assets.filter((e=>"css"===e.type)).length+1}.css`,"/* Styles */\n"),document.getElementById("addJs").onclick=()=>addAsset("js",`script-${assets.filter((e=>"js"===e.type)).length+1}.js`,"// Script\n"),document.getElementById("removeAsset").onclick=()=>{const e=assets.find((e=>e.id===activeAssetId));e&&log(`Deleted asset: ${e.name}`),assets=assets.filter((e=>e.id!==activeAssetId)),assets.length>0?selectAsset(assets[assets.length-1].id):selectAsset(null)},document.querySelectorAll(".tab-btn").forEach((e=>{e.onclick=()=>{document.querySelectorAll(".tab-btn").forEach((e=>e.classList.remove("active"))),document.querySelectorAll(".tab-content").forEach((e=>e.classList.add("hidden"))),e.classList.add("active"),document.getElementById(e.dataset.tab).classList.remove("hidden")}}));const dropBoundary=document.getElementById("dropBoundary"),dropOverlay=document.getElementById("dropOverlay");dropBoundary.addEventListener("dragover",(e=>{e.preventDefault(),dropOverlay.classList.remove("hidden")})),dropBoundary.addEventListener("dragleave",(e=>{null!==e.relatedTarget&&e.relatedTarget!==dropBoundary||dropOverlay.classList.add("hidden")})),dropBoundary.addEventListener("drop",(async e=>{e.preventDefault(),dropOverlay.classList.add("hidden");const t=Array.from(e.dataTransfer.files);if(0!==t.length)for(const e of t){const t=e.name.split(".").pop().toLowerCase();if(["png","jpg","jpeg","gif","svg","webp","ico"].includes(t)){const t=new FileReader;t.onload=t=>addAsset("media",e.name,t.target.result),t.readAsDataURL(e)}else{const n=await e.text();["html","htm"].includes(t)?addAsset("html",e.name,n):"css"===t?addAsset("css",e.name,n):"js"===t&&addAsset("js",e.name,n)}}}));const scanImageUsage=()=>{const e=assets.filter((e=>"media"===e.type)),t=assets.filter((e=>"html"===e.type)).map((e=>e.content)).join(" "),n=assets.filter((e=>"css"===e.type)).map((e=>e.content)).join(" "),s=assets.filter((e=>"js"===e.type)).map((e=>e.content)).join(" "),o=[],i=[];return e.forEach((e=>{const a=e.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),l=new RegExp(`(src|href)=["']([^"']*\\/)?${a}["']`,"i"),c=new RegExp(`url\\(\\s*["']?([^"')]*\\/)?${a}["']?\\s*\\)`,"i"),d=new RegExp(`["']([^"']*\\/)?${a}["']`,"i");let r=[];l.test(t)&&r.push("HTML"),c.test(n)&&r.push("CSS"),d.test(s)&&r.push("JS"),r.length>0?o.push({...e,foundIn:r}):i.push(e)})),{used:o,unused:i}},showUsageModal=(e,t)=>{refList.innerHTML="",unrefList.innerHTML="",e.forEach((e=>{const t=document.createElement("div");t.className="flex items-center gap-4 bg-white border-[3px] border-[#121212] p-3 shadow-[3px_3px_0_#000]",t.innerHTML=`\n            <img src="${e.content}" class="w-12 h-12 object-cover border border-[#333]">\n            <div class="flex-1 min-w-0">\n                <div class="font-mono text-xs font-bold truncate text-[#121212]">${e.name}</div>\n                <div class="text-[10px] uppercase text-[#58CC02] font-bold">Found in ${e.foundIn.join(" & ")}</div>\n            </div>\n            <div class="w-2 h-2 bg-[#58CC02] rounded-full"></div>\n        `,refList.appendChild(t)})),t.forEach((e=>{const t=document.createElement("div");t.className="flex items-center gap-4 bg-[#F8F8F3] border-[3px] border-[#ccc] p-3 opacity-70",t.innerHTML=`\n            <img src="${e.content}" class="w-12 h-12 object-cover grayscale border border-[#333]">\n            <div class="flex-1 min-w-0">\n                <div class="font-mono text-xs font-bold truncate text-[#666]">${e.name}</div>\n                <div class="text-[10px] uppercase text-[#FF3366] font-bold">Unused (Will Exclude)</div>\n            </div>\n        `,unrefList.appendChild(t)})),usageModal.classList.remove("hidden")};modalCancel.onclick=()=>usageModal.classList.add("hidden"),modalProceed.onclick=()=>{usageModal.classList.add("hidden");const{unused:e}=scanImageUsage(),t=e.map((e=>e.id));log(`<span class="text-[#FF3366] font-bold">Excluding ${e.length} unused media assets from bundle.</span>`),executeBuild(t)},document.getElementById("build").onclick=()=>{const e=assets.find((e=>e.id===activeAssetId));e&&"media"!==e.type&&(e.content=mainEditor.value);const{used:t,unused:n}=scanImageUsage();n.length>0?showUsageModal(t,n):executeBuild()};const diffContainer=document.getElementById("diffContainer"),previewBox=document.getElementById("previewBox"),diffOriginal=document.getElementById("diffOriginal"),diffOutput=document.getElementById("diffOutput"),diffOriginalLabel=document.getElementById("diffOriginalLabel"),diffOutputLabel=document.getElementById("diffOutputLabel");let precomputedDiffs={html:null,css:null,js:null,bundle:null};const generateDiff=(e=currentDiffTab)=>{"string"!=typeof e&&(e=currentDiffTab),currentDiffTab=e,document.querySelectorAll(".diff-tab").forEach((e=>{e.classList.remove("active","bg-[#333]"),e.classList.add("bg-[#222]","opacity-50","hover:opacity-100"),e.disabled=!1})),["html","css","js","bundle"].forEach((e=>{const t=document.getElementById(`diffTab${e.charAt(0).toUpperCase()+e.slice(1)}`);finals[e]||originals[e]||!t||t.classList.add("opacity-30","cursor-not-allowed")}));const t=document.getElementById(`diffTab${e.charAt(0).toUpperCase()+e.slice(1)}`);t&&(t.classList.add("active","bg-[#333]","opacity-100"),t.classList.remove("bg-[#222]","opacity-50"));const n=e.toUpperCase();diffOriginalLabel.textContent=`Original ${n}`,diffOutputLabel.textContent=`Build Output ${n}`;const s=document.getElementById("diffWrap").checked;diffOriginal.className="flex-1 p-4 font-mono text-xs overflow-auto text-[#444] leading-relaxed "+(s?"whitespace-pre-wrap break-all":"whitespace-pre"),diffOutput.className="flex-1 p-4 font-mono text-xs overflow-auto text-[#444] leading-relaxed "+(s?"whitespace-pre-wrap break-all":"whitespace-pre");const o=precomputedDiffs[e];o?(diffOriginal.innerHTML=o.originalHtml,diffOutput.innerHTML=o.outputHtml):(diffOriginal.innerHTML='<span class="text-[#888] italic">No content available for this type.</span>',diffOutput.innerHTML='<span class="text-[#888] italic">No content available for this type.</span>')};document.getElementById("diffTabHtml").onclick=()=>generateDiff("html"),document.getElementById("diffTabCss").onclick=()=>generateDiff("css"),document.getElementById("diffTabJs").onclick=()=>generateDiff("js"),document.getElementById("diffTabBundle").onclick=()=>generateDiff("bundle"),document.getElementById("openNewTab").onclick=()=>{if(!outputs.html)return void showToast("Build first to preview in new tab!","error");const e=new Blob([outputs.html],{type:"text/html"}),t=URL.createObjectURL(e);window.open(t,"_blank")},document.getElementById("diffCollapseBase64").onchange=generateDiff,document.getElementById("diffWrap").onchange=generateDiff;const getBuildConfig=()=>{const e=document.getElementById("optCDN").checked;return{mode:document.getElementById("mode").value,minifyHTML:document.getElementById("optMinifyHTML").checked,minifyCSS:document.getElementById("optMinifyCSS").checked,minifyJS:document.getElementById("optMinifyJS").checked,comments:document.getElementById("optComments").checked,console:document.getElementById("optConsole").checked,useCDN:e}},executeBuild=async(e=[])=>{const t=getBuildConfig();let n=assets.filter((t=>!e.includes(t.id))),s=n.filter((e=>"html"===e.type)),o=s[0];if(s.length>1&&"batch"!==t.mode&&log(`<span class='text-yellow-500'>Warning:</span> Multiple HTML files detected. Only the first (<span class="font-bold">${o.name}</span>) will be used as the Bundle entry point.`),0===n.length)return void log("<span class='text-[#FF3366]'>Error:</span> No assets to build.");"inline"!==t.mode||o||(log("<span class='text-yellow-500'>Note:</span> No HTML file found for Inline build. Auto-generating wrapper."),o={id:"virtual-wrapper",type:"html",name:"index.generated.html",content:'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="utf-8">\n  <title>Bundled App</title>\n</head>\n<body>\n  \x3c!-- Injected Content --\x3e\n</body>\n</html>'},n.push(o)),buildStatus.classList.remove("hidden");const i=document.getElementById("loadingOverlay"),a=document.getElementById("loadingSubtext");i.classList.add("active"),t.useCDN?(a.innerText="Downloading libraries from CDN...",a.classList.remove("hidden")):a.classList.add("hidden"),await new Promise((e=>setTimeout(e,0))),log("Starting modular build sequence..."),showToast("Build Started...");let l={};performance.now();try{l=await resolveLibraries()}catch(e){return log(`<span class="text-[#FF3366]">Lib Error:</span> ${e.message}`),void i.classList.remove("active")}const c=l.CleanCSS,d=l.minifyHTML,r=l.minifyJS;batchFiles=[],outputs={html:"",css:"",js:""},finals={html:"",css:"",js:"",bundle:""},originals={html:"",css:"",js:"",bundle:""},precomputedDiffs={html:null,css:null,js:null,bundle:null};try{c&&!cachedCleanCSSInstance&&(cachedCleanCSSInstance=new c);const e=n.filter((e=>"css"===e.type)),s=n.filter((e=>"js"===e.type)),i=n.filter((e=>"html"===e.type)),a=n.filter((e=>!["css","js","html"].includes(e.type))),l=e.map((async e=>{await new Promise((e=>setTimeout(e,0)));let n=e.content;return t.minifyCSS&&cachedCleanCSSInstance?n=cachedCleanCSSInstance.minify(n).styles:t.comments&&(n=n.replace(/\/\*[\s\S]*?\*\//g,"")),{...e,content:n}})),m=s.map((async e=>{await new Promise((e=>setTimeout(e,0)));let n=e.content;if(t.minifyJS&&r)n=(await r(n,{compress:{drop_console:t.console}})).code;else if((t.comments||t.console)&&r){const e={compress:{drop_console:t.console,defaults:!1},mangle:!1,format:{beautify:!0,comments:!t.comments}};n=(await r(n,e)).code}return{...e,content:n}})),u=i.map((async e=>{await new Promise((e=>setTimeout(e,0)));let s=e.content;if((t.minifyHTML||t.minifyCSS||t.minifyJS||t.comments)&&d){1===n.length&&log("Single HTML detected: Optimizing embedded resources...");const e=!!t.minifyJS&&{compress:{drop_console:t.console}};s=await d(s,{collapseWhitespace:t.minifyHTML,removeComments:t.comments,minifyCSS:t.minifyCSS,minifyJS:e,ignoreCustomFragments:[/<script type="x-shader\/.*?"[\s\S]*?<\/script>/gi]})}return{...e,content:s}})),[p,f,g]=await Promise.all([Promise.all(l),Promise.all(m),Promise.all(u)]),h=[...p,...f,...g,...a];if("batch"===t.mode)log("Mode: Batch (Passthrough)"),batchFiles=h,originals={html:"",css:"",js:"",bundle:""},finals={html:"",css:"",js:"",bundle:""},outputs={html:"",css:"",js:"",bundle:""};else{let e=h.filter((e=>"css"===e.type)).map((e=>e.content)).join("\n"),s=h.filter((e=>"js"===e.type)).map((e=>e.content)).join("\n"),i=o?o.content:"";originals.css=n.filter((e=>"css"===e.type)).map((e=>e.content)).join("\n"),originals.js=n.filter((e=>"js"===e.type)).map((e=>e.content)).join("\n"),originals.html=n.find((e=>"html"===e.type))?.content||o.content;const a=n.filter((e=>"media"===e.type));if("inline"===t.mode&&a.length>0&&a.forEach((t=>{const n=t.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=new RegExp(`(['"\\(])(?:[^'"\\(\\)]*?\\/)?${n}(['"\\)])`,"g");i=i.replace(s,((e,n,s)=>`${n}${t.content}${s}`)),e=e.replace(s,((e,n,s)=>`${n}${t.content}${s}`))})),t.minifyHTML&&d){const e=!!t.minifyJS&&{compress:{drop_console:t.console}};i=await d(i,{collapseWhitespace:!0,removeComments:t.comments,minifyCSS:t.minifyCSS,minifyJS:e,ignoreCustomFragments:[/<script type="x-shader\/.*?"[\s\S]*?<\/script>/gi]})}let l=i;if("inline"===t.mode)log("Mode: Inline Assembly"),e&&l&&(l.includes("</head>")?l=l.replace("</head>",`<style>${e}</style></head>`):l.includes("<body")?l=l.replace(/<body/i,`<style>${e}</style><body`):l+=`<style>${e}</style>`),s&&l&&(l.includes("</body>")?l=l.replace("</body>",`<script>${s}<\/script></body>`):l.includes("</html>")?l=l.replace("</html>",`<script>${s}<\/script></html>`):l+=`<script>${s}<\/script>`);else if("bundle"===t.mode){log("Mode: Bundle Assembly");const t=document.getElementById("outNameC").value||"styles.min.css",n=document.getElementById("outNameJ").value||"scripts.min.js";l&&(e&&(l=l.replace("</head>",`<link rel="stylesheet" href="${t}">\n</head>`)),s&&(l=l.replace("</body>",`<script src="${n}"><\/script>\n</body>`)))}if(outputs={html:l,css:e,js:s},finals={...outputs},originals.bundle=originals.html,finals.bundle=l,"inline"===t.mode){const e=h.find((e=>"html"===e.type));finals.html=e?e.content:h.find((e=>"virtual-wrapper"===e.id))?.content||""}else finals.html=l}log("Calculating diffs...");const y=performance.now(),b=["html","css","js","bundle"],w=document.getElementById("diffCollapseBase64").checked,x=/data:image\/[^;]+;base64,[a-zA-Z0-9+/=]+/g,v="[...BASE64...]";for(const e of b){let t=originals[e]||"",n=finals[e]||"";if(!t&&!n){precomputedDiffs[e]=null;continue}if(!Diff||"function"!=typeof Diff.diffWords){log("<span class='text-yellow-500'>Warning:</span> Diff library not loaded. Showing raw content."),precomputedDiffs[e]={originalHtml:t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),outputHtml:n.replace(/</g,"&lt;").replace(/>/g,"&gt;")};continue}w&&(t=t.replace(x,v),n=n.replace(x,v));const s=5e4,o=25e4,i=t.length+n.length;if(i>o){log(`<span class='text-yellow-500'>Warning:</span> Diff skipped for ${e.toUpperCase()} because files are too large (${formatBytes(i)}). Showing raw output to prevent browser crash.`),precomputedDiffs[e]={originalHtml:'<span class="text-yellow-600 block mb-4 border-b border-yellow-800 pb-2">File too large to render diff gracefully.</span>\n'+t.substring(0,1e4).replace(/</g,"&lt;").replace(/>/g,"&gt;")+"\n\n... (file truncated in view)",outputHtml:'<span class="text-yellow-600 block mb-4 border-b border-yellow-800 pb-2">Showing full text preview only.</span>\n'+n.replace(/</g,"&lt;").replace(/>/g,"&gt;")};continue}let a=[];i>s?(log(`<span class='text-[#555]'>Note:</span> Using fast line-diff for ${e.toUpperCase()} to maintain performance.`),a=Diff.diffLines(t,n)):a=Diff.diffWords(t,n);let l="",c="";a.forEach((e=>{const t=e.value.replace(/</g,"&lt;").replace(/>/g,"&gt;");e.added?l+=`<span class="bg-green-200 text-green-900 font-bold">${t}</span>`:e.removed?c+=`<span class="bg-red-200 text-red-900 font-bold">${t}</span>`:(l+=`<span class="text-gray-500">${t}</span>`,c+=`<span class="text-gray-500">${t}</span>`)})),precomputedDiffs[e]={originalHtml:c,outputHtml:l},await new Promise((e=>setTimeout(e,10)))}log(`Diffs computed in ${(performance.now()-y).toFixed(0)}ms`),"batch"===t.mode?document.getElementById("previewFrame").srcdoc="<html><body><h2 style='font-family:monospace; text-align:center; margin-top:20%'>BATCH MODE PREVIEW UNAVAILABLE<br>Download ZIP to inspect files.</h2></body></html>":document.getElementById("previewFrame").srcdoc=outputs.html,generateDiff(),"batch"===t.mode?(document.getElementById("downH").classList.add("hidden"),document.getElementById("downC").classList.add("hidden"),document.getElementById("downJ").classList.add("hidden"),document.getElementById("optZip").checked=!0):(document.getElementById("downH").classList.toggle("hidden",!outputs.html),document.getElementById("downC").classList.toggle("hidden",!outputs.css),document.getElementById("downJ").classList.toggle("hidden",!outputs.js)),log("<span class='text-[#58CC02] font-bold'>Build Complete.</span>"),showToast("Build Success!","success"),document.querySelector('[data-tab="output"]').click()}catch(e){log(`<span class="text-[#FF3366]">Error:</span> ${e.message}`),showToast("Build Failed","error")}finally{buildStatus.classList.add("hidden"),document.getElementById("loadingOverlay").classList.remove("active")}},dl=(e,t)=>{if(!t)return;const n=document.createElement("a");n.href=URL.createObjectURL(new Blob([t],{type:"text/plain"})),n.download=e,n.click()};document.getElementById("downH").onclick=()=>dl(document.getElementById("outNameH").value||"index.min.html",outputs.html),document.getElementById("downC").onclick=()=>dl(document.getElementById("outNameC").value||"styles.min.css",outputs.css),document.getElementById("downJ").onclick=()=>dl(document.getElementById("outNameJ").value||"scripts.min.js",outputs.js);const downloadAsZip=async()=>{if("undefined"==typeof JSZip)return void showToast("JSZip not loaded!","error");const e=new JSZip,t=getBuildConfig(),n=document.getElementById("outNameH").value||"index.min.html",s=document.getElementById("outNameC").value||"styles.min.css",o=document.getElementById("outNameJ").value||"scripts.min.js";if(outputs.html&&"batch"!==t.mode&&e.file(n,outputs.html),outputs.css&&"batch"!==t.mode&&e.file(s,outputs.css),outputs.js&&"batch"!==t.mode&&e.file(o,outputs.js),"bundle"===t.mode){const t=assets.filter((e=>"media"===e.type));t.forEach((t=>{const n=t.content.split(",")[1];e.file(t.name,n,{base64:!0})}));const n=assets.filter((e=>"html"===e.type));n.length>1&&n.slice(1).forEach(((t,n)=>{e.file(t.name,t.content)}))}"batch"===t.mode&&batchFiles.forEach((t=>{let n=t.name;if("media"!==t.type)"css"===t.type&&document.getElementById("optMinifyCSS").checked&&(n=n.replace(/\.css/i,".min.css")),"js"===t.type&&document.getElementById("optMinifyJS").checked&&(n=n.replace(/\.js/i,".min.js")),"html"===t.type&&document.getElementById("optMinifyHTML").checked&&(n=n.replace(/\.html/i,".min.html")),e.file(n,t.content);else{const s=t.content.split(",")[1];e.file(n,s,{base64:!0})}}));const i=await e.generateAsync({type:"blob"}),a=document.createElement("a");a.href=URL.createObjectURL(i),a.download="bundle.zip",a.click(),showToast("ZIP Downloaded!","success")};document.getElementById("downA").onclick=()=>{document.getElementById("optZip").checked?downloadAsZip():(dl(document.getElementById("outNameH").value||"index.min.html",outputs.html),outputs.css&&dl(document.getElementById("outNameC").value||"styles.min.css",outputs.css),outputs.js&&dl(document.getElementById("outNameJ").value||"scripts.min.js",outputs.js))};const modeSelector=document.getElementById("mode"),zipCheckbox=document.getElementById("optZip"),zipLabel=document.getElementById("zipToggleLabel"),updateZipToggleState=()=>{const e=modeSelector.value;"inline"===e?(zipCheckbox.disabled=!0,zipCheckbox.checked=!1,zipLabel.classList.add("opacity-50","cursor-not-allowed")):"batch"===e?(zipCheckbox.disabled=!0,zipCheckbox.checked=!0,zipLabel.classList.add("opacity-50","cursor-not-allowed")):(zipCheckbox.disabled=!1,zipLabel.classList.remove("opacity-50","cursor-not-allowed"))};modeSelector.addEventListener("change",updateZipToggleState),updateZipToggleState(),document.getElementById("togglePreview").onclick=()=>{document.getElementById("previewBox").classList.toggle("hidden")};const extractorInput=document.getElementById("extractorInput"),extractorUploadBtn=document.getElementById("extractorUploadBtn"),extractorList=document.getElementById("extractorList"),extractorDownloadAll=document.getElementById("extractorDownloadAll"),extractorEmptyState=document.getElementById("extractorEmptyState"),extBase64Dec=document.getElementById("extBase64Dec");let extractedAssets=[];extractorUploadBtn.onclick=()=>extractorInput.click(),extractorInput.onchange=async e=>{const t=e.target.files[0];if(!t)return;log(`[EXTRACTOR] Processing file: <span class="text-[#FF3366]">${t.name}</span>...`);const n=await t.text(),s=(new DOMParser).parseFromString(n,"text/html");extractedAssets=[];let o=1;const i=(e,t,n)=>{extractedAssets.push({id:o++,name:e,content:t,type:n})},a=s.querySelectorAll("style");a.forEach(((e,t)=>{let n=e.innerHTML,o=1===a.length?"extracted_style.css":`extracted_style_${t+1}.css`;i(o,n,"css");const l=s.createElement("link");l.rel="stylesheet",l.href=o,e.replaceWith(l)}));const l=s.querySelectorAll("script");if(l.forEach(((e,t)=>{if(e.hasAttribute("src"))return;const n=e.getAttribute("type");if(n&&n.includes("x-shader")){let s=n.includes("fragment")?"frag":n.includes("vertex")?"vert":"glsl";return void i(`shader_${t+1}.${s}`,e.innerHTML,"glsl")}let o=1===l.length?"extracted_script.js":`extracted_script_${t+1}.js`;i(o,e.innerHTML,"js");const a=s.createElement("script");a.src=o,a.defer=!0,e.replaceWith(a)})),extBase64Dec.checked){s.querySelectorAll('img[src^="data:image"]').forEach(((e,t)=>{const n=e.getAttribute("src"),s=n.match(/data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+).*,/);if(s){const o=s[1];let a="png";o.includes("jpeg")||o.includes("jpg")?a="jpg":o.includes("gif")?a="gif":o.includes("svg")?a="svg":o.includes("webp")&&(a="webp");const l=`extracted_image_${t+1}.${a}`;i(l,n,"image"),e.setAttribute("src",l)}}))}const c=`<!DOCTYPE html>\n${s.documentElement.lang?'<html lang="'+s.documentElement.lang+'">':"<html>"}\n${s.documentElement.innerHTML}\n</html>`;i("index_extracted.html",c,"html"),log(`[EXTRACTOR] Extraction complete. Found ${extractedAssets.length} distinct assets.`),showToast("Extraction Complete","success"),renderExtractorList(),extractorInput.value=""};const renderExtractorList=()=>{if(extractorList.innerHTML="",0===extractedAssets.length)return extractorList.appendChild(extractorEmptyState),extractorDownloadAll.disabled=!0,void extractorDownloadAll.classList.add("hidden");extractorDownloadAll.disabled=!1,extractorDownloadAll.classList.remove("hidden");const e=document.createDocumentFragment();extractedAssets.forEach((t=>{let n="image"===t.type?Math.round(.75*(t.content.length-t.content.indexOf(","))):new Blob([t.content]).size,s="#FF3366";"html"===t.type?s="#121212":"css"===t.type?s="#0055ff":"js"===t.type?s="#eebb00":"glsl"===t.type&&(s="#9900ff");const o=document.createElement("div");o.className="flex justify-between items-center p-3 bg-white border border-[#ccc] brutal-shadow mb-2 hover:border-[#121212] transition-colors",o.innerHTML=`\n          <div class="flex items-center gap-3">\n             <div class="w-3 h-3 rounded-full border border-black" style="background:${s}"></div>\n             <div>\n                <div class="font-bold text-sm font-mono text-[#121212]">${t.name}</div>\n                <div class="text-[10px] text-[#888] font-mono">${formatBytes(n)} ‚Ä¢ ${t.type.toUpperCase()}</div>\n             </div>\n          </div>\n          <button class="bg-[#121212] flex items-center gap-1 text-white hover:bg-[#FF3366] text-[10px] px-3 py-2 font-bold tracking-wider uppercase" onclick="downloadExtractedAsset(${t.id})"><span>‚¨á</span> Save</button>\n        `,e.appendChild(o)})),extractorList.appendChild(e)};window.downloadExtractedAsset=e=>{const t=extractedAssets.find((t=>t.id===e));if(t)if("image"===t.type){const e=document.createElement("a");e.href=t.content,e.download=t.name,e.click()}else dl(t.name,t.content)},extractorDownloadAll.onclick=async()=>{if(0===extractedAssets.length)return;if("undefined"==typeof JSZip)return void showToast("JSZip not loaded!","error");const e=new JSZip;extractedAssets.forEach((t=>{if("image"===t.type){const n=t.content.split(",")[1];e.file(t.name,n,{base64:!0})}else e.file(t.name,t.content)}));try{const t=await e.generateAsync({type:"blob"}),n=URL.createObjectURL(t),s=document.createElement("a");s.href=n,s.download="extracted_project.zip",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n),showToast("Extraction ZIP Downloaded","success")}catch(e){showToast("ZIP Generation Failed","error"),log(`<span class="text-[#FF3366]">Extractor ZIP Error: ${e.message}</span>`)}};const cursor=document.getElementById("cursor");if(cursor){let e=0,t=0,n=!1;document.addEventListener("mousemove",(s=>{e=s.clientX,t=s.clientY,n||(n=!0,requestAnimationFrame((()=>{cursor.style.transform=`translate3d(calc(${e}px - 50%), calc(${t}px - 50%), 0)`,n=!1})))}));const s="a, button, .tab-btn, .asset-item";document.addEventListener("mouseover",(e=>{e.target.closest(s)&&cursor.classList.add("hovered")})),document.addEventListener("mouseout",(e=>{e.target.closest(s)&&cursor.classList.remove("hovered")}))}renderAssetList()</script></body></html>