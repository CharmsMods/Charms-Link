<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Minimal Dark Mode Image Degrader</title><script src="https://cdn.tailwindcss.com"></script><style>body{font-family:'Courier New',Courier,monospace}.minimal-container{background-color:#000;color:#fff;min-height:100vh;padding:2rem}.minimal-border{border:1px solid #fff}.minimal-input,input[type=file],input[type=number]{margin-top:.5rem;padding:.5rem;border:1px solid #fff;background:#000;color:#fff}input[type=file]::-webkit-file-upload-button{background:#fff;color:#000;border:1px solid #fff;padding:.5rem;cursor:pointer}#main-layout{display:flex;flex-direction:column;gap:1.5rem}#canvas{max-width:100%;max-height:calc(100vh - 400px);height:auto;border:1px solid #fff;display:block;margin-top:0;margin-bottom:0;background-color:#0f0f0f;object-fit:contain}#main-layout.layout-side{flex-direction:row;align-items:flex-start}#main-layout.layout-side #sidebar{width:320px;flex-shrink:0}#main-layout.layout-side #canvas{max-width:none;max-height:calc(100vh - 200px);flex-grow:1;height:auto}#controls-block{margin-bottom:0}</style></head><body><div class="minimal-container"><h1 class="text-4xl font-bold mb-1 uppercase tracking-tighter">Image Degrader</h1><p class="text-sm mb-8 uppercase tracking-widest opacity-70">Iterative Compression Tool</p><div id="main-layout" class="layout-default"><div id="sidebar"><div id="controls-block" class="minimal-border p-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-4"><label class="flex flex-col text-xs font-bold uppercase tracking-wider">Image Upload <input id="file" type="file" accept="image/*" class="minimal-input"></label> <label class="flex flex-col text-xs font-bold uppercase tracking-wider">Iterations <input id="iterations" type="number" min="1" max="200" value="5" class="minimal-input"></label> <label class="flex flex-col text-xs font-bold uppercase tracking-wider">JPEG Quality (0–1) <input id="quality" type="number" step="0.01" min="0" max="1" value="0.6" class="minimal-input"></label> <label class="flex flex-col text-xs font-bold uppercase tracking-wider">Downscale Factor <input id="downscale" type="number" step="0.1" min="1" max="4" value="1.5" class="minimal-input"></label> <label class="flex flex-col text-xs font-bold uppercase tracking-wider">Noise (0–1) <input id="noise" type="number" step="0.01" min="0" max="1" value="0.02" class="minimal-input"></label> <label class="flex flex-col text-xs font-bold uppercase tracking-wider">Posterize Levels <input id="posterize" type="number" step="1" min="1" max="32" value="32" class="minimal-input"></label></div><div id="action-bar" class="flex flex-wrap gap-3 items-center mb-6"><button id="start" class="px-5 py-3 text-sm font-bold uppercase tracking-wider minimal-border bg-white text-black transition-colors duration-150 hover:bg-black hover:text-white disabled:opacity-40 disabled:cursor-not-allowed">Start</button> <button id="stop" disabled="disabled" class="px-5 py-3 text-sm font-bold uppercase tracking-wider minimal-border bg-white text-black transition-colors duration-150 hover:bg-black hover:text-white disabled:opacity-40 disabled:cursor-not-allowed">Stop</button> <a id="download" download="degraded.jpg" class="px-5 py-3 text-sm font-bold uppercase tracking-wider minimal-border bg-black text-white hover:bg-white hover:text-black transition-colors duration-150 inline-block">Download</a><div id="status" class="px-4 py-3 text-xs font-bold uppercase tracking-wider minimal-border bg-white text-black">Ready</div></div></div><canvas id="canvas"></canvas></div></div><script>const fileInput=document.getElementById("file"),canvas=document.getElementById("canvas"),mainLayout=document.getElementById("main-layout"),ctx=canvas.getContext("2d",{willReadFrequently:!0}),startBtn=document.getElementById("start"),stopBtn=document.getElementById("stop"),downloadLink=document.getElementById("download"),status=document.getElementById("status");let stopRequested=!1;function applyNoise(t,e){if(e<=0)return;const a=t.data,n=a.length;for(let t=0;t<n;t+=4){const n=255*(2*Math.random()-1)*e,o=255*(2*Math.random()-1)*e,s=255*(2*Math.random()-1)*e;a[t]=Math.max(0,Math.min(255,a[t]+n)),a[t+1]=Math.max(0,Math.min(255,a[t+1]+o)),a[t+2]=Math.max(0,Math.min(255,a[t+2]+s))}}function applyPosterize(t,e){if(e<=1||e>=256)return;const a=255/(e-1),n=t.data;for(let t=0;t<n.length;t+=4)n[t]=Math.round(n[t]/a)*a,n[t+1]=Math.round(n[t+1]/a)*a,n[t+2]=Math.round(n[t+2]/a)*a}async function canvasToBlobAsync(t,e){return await new Promise(a=>canvas.toBlob(a,t,e))}async function degradeLoop({iterations:t,quality:e,downscale:a,noise:n,posterize:o}){stopRequested=!1,startBtn.disabled=!0,stopBtn.disabled=!1;const s=canvas.width,d=canvas.height;if(0===s||0===d)return status.textContent="Error: No image loaded.",startBtn.disabled=!1,void(stopBtn.disabled=!0);for(let i=0;i<t&&!stopRequested;++i){if(status.textContent=`Iteration ${i+1}/${t}`,a>1){const t=Math.max(1,Math.round(s/a)),e=Math.max(1,Math.round(d/a)),n=document.createElement("canvas");n.width=t,n.height=e;n.getContext("2d").drawImage(canvas,0,0,t,e),ctx.clearRect(0,0,s,d),ctx.imageSmoothingEnabled=!1,ctx.drawImage(n,0,0,s,d),ctx.imageSmoothingEnabled=!0}if(n>0||o<256){let t=ctx.getImageData(0,0,s,d);n>0&&applyNoise(t,n),o<256&&applyPosterize(t,o),ctx.putImageData(t,0,0)}const c=await canvasToBlobAsync("image/jpeg",e);if(!c)break;const l=await createImageBitmap(c);ctx.clearRect(0,0,s,d),ctx.drawImage(l,0,0,s,d),await new Promise(t=>setTimeout(t,8))}const i=await canvasToBlobAsync("image/jpeg",e);i?(downloadLink.href=URL.createObjectURL(i),downloadLink.download=`degraded-${Date.now()}.jpg`,status.textContent=stopRequested?"Stopped":"Done"):status.textContent="Failed to generate final file",startBtn.disabled=!1,stopBtn.disabled=!0}fileInput.addEventListener("change",async t=>{const e=t.target.files?.[0];if(!e)return;const a=await createImageBitmap(e),n=Math.min(1,2048/Math.max(a.width,a.height));canvas.width=Math.round(a.width*n),canvas.height=Math.round(a.height*n),ctx.clearRect(0,0,canvas.width,canvas.height),ctx.drawImage(a,0,0,canvas.width,canvas.height);canvas.width/canvas.height<=1.1?window.innerWidth>=768&&mainLayout.classList.add("layout-side"):mainLayout.classList.remove("layout-side"),canvas.toBlob(t=>{t&&(downloadLink.href=URL.createObjectURL(t),downloadLink.download="degraded-start.jpg")},"image/jpeg",.95),status.textContent="Image loaded"}),startBtn.addEventListener("click",()=>{const t=parseInt(document.getElementById("iterations").value,10)||1,e=parseFloat(document.getElementById("quality").value)||.6,a=Math.max(1,parseFloat(document.getElementById("downscale").value)||1),n=parseFloat(document.getElementById("noise").value)||0,o=parseInt(document.getElementById("posterize").value,10)||256;0!==canvas.width&&0!==canvas.height?degradeLoop({iterations:t,quality:e,downscale:a,noise:n,posterize:o}):status.textContent="Error: Please upload an image first."}),stopBtn.addEventListener("click",()=>{stopRequested=!0})</script></body></html>