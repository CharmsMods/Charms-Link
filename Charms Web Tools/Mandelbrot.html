<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>64-Bit GPU Mandelbrot</title><style>:root{--bg:#030303;--panel:#111111;--accent:#00ffcc;--text:#ffffff}body,html{margin:0;padding:0;width:100%;height:100%;overflow:hidden;background:var(--bg);font-family:Consolas,monospace;color:var(--text)}#ui{position:absolute;top:20px;left:20px;width:280px;background:var(--panel);padding:20px;border:1px solid #333;box-shadow:0 0 30px #000;z-index:10;border-radius:2px}h2{margin:0 0 15px 0;font-size:.9rem;color:var(--accent);letter-spacing:2px;border-bottom:1px solid #222;padding-bottom:10px}.row{margin-bottom:15px}label{display:flex;justify-content:space-between;font-size:.65rem;color:#888;margin-bottom:4px;text-transform:uppercase}input[type=range]{width:100%;cursor:crosshair;accent-color:var(--accent)}input[type=number]{width:48%;background:#000;border:1px solid #444;color:var(--accent);padding:5px;font-family:inherit}button{width:100%;padding:12px;background:0 0;border:1px solid var(--accent);color:var(--accent);font-weight:700;cursor:pointer;transition:.2s;margin-top:10px}button:hover{background:var(--accent);color:#000}#stats{font-size:.6rem;color:#444;margin-top:15px;line-height:1.6}canvas{display:block}</style></head><body><div id="ui"><h2>â–£ PRECISION_EXPANSION_v2</h2><div class="row"><label>Detail (Iter) <span id="v-iter">256</span></label> <input type="range" id="iter" min="64" max="3000" value="256"></div><div class="row"><label>Color Shift <span id="v-hue">190</span></label> <input type="range" id="hue" min="0" max="360" value="190"></div><div class="row"><label>Brightness <span id="v-bright">1.0</span></label> <input type="range" id="bright" min="0.1" max="5.0" step="0.1" value="1.0"></div><div class="row" style="display:flex;justify-content:space-between"><input type="number" id="expW" value="1920"> <input type="number" id="expH" value="1080"></div><button onclick="exportImage()">ðŸ“· RENDER 64-BIT PNG</button><div id="stats">MODE: EMULATED_FLOAT64<br>ZOOM: <span id="s-zoom">1.0</span><br>POS_X: <span id="s-x">0</span></div></div><canvas id="glCanvas"></canvas><script id="vs" type="x-shader/x-vertex">attribute vec2 pos;
    void main() { gl_Position = vec4(pos, 0.0, 1.0); }</script><script id="fs" type="x-shader/x-fragment">precision highp float;
    uniform vec2 u_res;
    uniform vec2 u_offH, u_offL; // High and Low parts of offset
    uniform vec2 u_zoomH, u_zoomL;
    uniform float u_hue, u_iter, u_bright;

    // --- Double-Single Math Functions ---
    vec2 ds_set(float a) { return vec2(a, 0.0); }
    
    vec2 ds_add(vec2 d1, vec2 d2) {
        float t1 = d1.x + d2.x;
        float e = t1 - d1.x;
        float t2 = ((d2.x - e) + (d1.x - (t1 - e))) + d1.y + d2.y;
        float s1 = t1 + t2;
        float s2 = t2 - (s1 - t1);
        return vec2(s1, s2);
    }

    vec2 ds_mul(vec2 d1, vec2 d2) {
        float c11 = d1.x * d2.x;
        float c12 = d1.x * d2.y;
        float c21 = d1.y * d2.x;
        float t1 = c11;
        float t2 = c12 + c21;
        float s1 = t1 + t2;
        float s2 = t2 - (s1 - t1);
        return vec2(s1, s2);
    }

    vec3 hsv2rgb(vec3 c) {
        vec4 K = vec4(1.0, 2.0/3.0, 1.0/3.0, 3.0);
        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
    }

    void main() {
        float ratio = u_res.x / u_res.y;
        vec2 uv = (gl_FragCoord.xy / u_res.xy) - 0.5;
        uv.x *= ratio;

        // Map UV to 64-bit space
        vec2 cx = ds_add(ds_mul(ds_set(uv.x), ds_add(u_zoomH, u_zoomL)), u_offH);
        vec2 cy = ds_add(ds_mul(ds_set(uv.y), ds_add(u_zoomH, u_zoomL)), u_offL);

        vec2 zx = vec2(0.0), zy = vec2(0.0);
        float iter = 0.0;

        for (float i = 0.0; i < 5000.0; i++) {
            if (i >= u_iter) break;
            
            // z = z^2 + c in DS precision
            vec2 zx2 = ds_mul(zx, zx);
            vec2 zy2 = ds_mul(zy, zy);
            vec2 new_zx = ds_add(ds_add(zx2, ds_mul(zy2, ds_set(-1.0))), cx);
            vec2 new_zy = ds_add(ds_mul(ds_mul(zx, zy), ds_set(2.0)), cy);
            
            zx = new_zx; zy = new_zy;
            if (zx.x*zx.x + zy.x*zy.x > 8.0) break;
            iter++;
        }

        if (iter == u_iter) {
            gl_FragColor = vec4(0,0,0,1);
        } else {
            float sn = iter - log2(log2(zx.x*zx.x + zy.x*zy.x)) + 4.0;
            vec3 col = hsv2rgb(vec3(fract(u_hue/360.0 + sn*0.02), 0.8, u_bright * (iter/u_iter * 5.0)));
            gl_FragColor = vec4(col, 1.0);
        }
    }</script><script>const canvas=document.getElementById("glCanvas"),gl=canvas.getContext("webgl",{preserveDrawingBuffer:!0});let zoom=4,offX=-.5,offY=0;function split(e){let t=Math.fround(e);return[t,Math.fround(e-t)]}const createShader=(e,t)=>{const o=gl.createShader(e);return gl.shaderSource(o,t),gl.compileShader(o),o},prog=gl.createProgram();gl.attachShader(prog,createShader(gl.VERTEX_SHADER,document.getElementById("vs").text)),gl.attachShader(prog,createShader(gl.FRAGMENT_SHADER,document.getElementById("fs").text)),gl.linkProgram(prog),gl.useProgram(prog);const buf=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,buf),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),gl.STATIC_DRAW);const pLoc=gl.getAttribLocation(prog,"pos");gl.enableVertexAttribArray(pLoc),gl.vertexAttribPointer(pLoc,2,gl.FLOAT,!1,0,0);const u={res:gl.getUniformLocation(prog,"u_res"),offH:gl.getUniformLocation(prog,"u_offH"),offL:gl.getUniformLocation(prog,"u_offL"),zoomH:gl.getUniformLocation(prog,"u_zoomH"),zoomL:gl.getUniformLocation(prog,"u_zoomL"),hue:gl.getUniformLocation(prog,"u_hue"),iter:gl.getUniformLocation(prog,"u_iter"),bright:gl.getUniformLocation(prog,"u_bright")};function render(){gl.viewport(0,0,canvas.width,canvas.height);const[e,t]=split(offX),[o,n]=split(offY),[r,a]=split(zoom),i=(e,t)=>{const o=document.getElementById(e);return o?o.value:t};gl.uniform2f(u.res,canvas.width,canvas.height),gl.uniform2f(u.offH,e,t),gl.uniform2f(u.offL,o,n),gl.uniform2f(u.zoomH,r,a),gl.uniform1f(u.hue,parseFloat(i("hue",190))),gl.uniform1f(u.iter,parseFloat(i("iter",256))),gl.uniform1f(u.bright,parseFloat(i("bright",1))),gl.drawArrays(gl.TRIANGLES,0,6);const g=(e,t)=>{const o=document.getElementById(e);o&&(o.innerText=t)};g("v-iter",i("iter",256)),g("s-zoom",(1/zoom).toExponential(3)),g("s-x",offX.toFixed(10))}window.addEventListener("wheel",e=>{zoom*=e.deltaY>0?1.1:.9,render()},{passive:!0});let lx,ly,drag=!1;function exportImage(){const e=canvas.width,t=canvas.height,o=document.getElementById("iter").value,n=(Math.max(parseInt(document.getElementById("expW").value)/e,parseInt(document.getElementById("expH").value)/t),Math.max(1,Math.log10(1/zoom))),r=Math.min(1e4*(1+.5*n),5e4),a=document.getElementById("stats"),i=a.innerHTML;a.innerHTML="PREPARING EXPORT...",setTimeout(()=>{document.getElementById("iter").value=Math.round(r),document.getElementById("v-iter").textContent=Math.round(r),a.innerHTML=`RENDERING ${Math.round(r).toLocaleString()} ITERATIONS...`,canvas.offsetHeight;const n=parseInt(document.getElementById("expW").value),g=parseInt(document.getElementById("expH").value);canvas.width=n,canvas.height=g,render(),requestAnimationFrame(()=>{setTimeout(()=>{const l=document.createElement("a");l.download=`fractal_64bit_${n}x${g}_iter${Math.round(r)}_${Date.now()}.png`;const c=document.createElement("canvas");c.width=n,c.height=g;c.getContext("2d").drawImage(canvas,0,0),l.href=c.toDataURL("image/png",1),document.body.appendChild(l),l.click(),document.body.removeChild(l),canvas.width=e,canvas.height=t,document.getElementById("iter").value=o,document.getElementById("v-iter").textContent=o,a.innerHTML=i,render()},100)})},100)}window.onmousedown=e=>{e.target===canvas&&(drag=!0,lx=e.clientX,ly=e.clientY)},window.onmouseup=()=>drag=!1,window.onmousemove=e=>{if(drag){const t=canvas.width/canvas.height;offX-=(e.clientX-lx)/canvas.width*zoom*t,offY+=(e.clientY-ly)/canvas.height*zoom,lx=e.clientX,ly=e.clientY,render()}};const resize=()=>{canvas.width=window.innerWidth,canvas.height=window.innerHeight,render()};window.onresize=resize,document.querySelectorAll("input").forEach(e=>e.oninput=render),resize()</script></body></html>