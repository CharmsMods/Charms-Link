<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Transformer Stack</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-color: #030303;
            --accent-color: #00ff88;
            --accent-glow: rgba(0, 255, 136, 0.3);
            --card-bg: rgba(20, 20, 20, 0.6);
            --border-color: rgba(255, 255, 255, 0.08);
            --text-primary: #f0f0f0;
            --text-secondary: #888;
            --font-main: 'Outfit', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
            --row-height: 48px;
            --glass-blur: 16px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            user-select: none;
        }

        body {
            background: radial-gradient(circle at 50% 100%, #0a0a0a 0%, #030303 100%);
            color: var(--text-primary);
            font-family: var(--font-main);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            letter-spacing: -0.01em;
        }

        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 24px;
            gap: 24px;
            height: 100%;
            overflow: hidden;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
        }

        @media (min-width: 1100px) {
            .container {
                flex-direction: row;
            }
        }

        .pane-group {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 24px;
            min-width: 0;
        }

        .pane {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--card-bg);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 20px;
            position: relative;
            transition: border-color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .pane:focus-within {
            border-color: rgba(255, 255, 255, 0.15);
        }

        .pane-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--text-secondary);
            margin-bottom: 12px;
            font-weight: 600;
        }

        textarea,
        .output-content {
            flex: 1;
            background: transparent;
            color: var(--text-primary);
            border: none;
            resize: none;
            font-family: var(--font-mono);
            font-size: 1.1rem;
            line-height: 1.6;
            outline: none;
            width: 100%;
            user-select: text;
            white-space: pre-wrap;
        }

        textarea::placeholder {
            color: #444;
        }

        .output-content {
            overflow-y: auto;
        }

        .copy-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: #fff;
            border: none;
            color: #000;
            padding: 8px 16px;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
            background: var(--accent-color);
        }

        .copy-btn:active {
            transform: translateY(0);
        }

        .stack-section {
            display: flex;
            flex-direction: column;
            background: var(--card-bg);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--border-color);
            border-radius: 16px;
            width: 100%;
            height: 450px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            overflow: hidden;
        }

        @media (min-width: 1100px) {
            .stack-section {
                width: 380px;
                height: 100%;
                min-width: 380px;
            }
        }

        .stack-header {
            padding: 20px 24px;
            background: rgba(255, 255, 255, 0.02);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stack-header span:first-child {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .stack-header span:last-child {
            font-size: 0.6rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .stack-list {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .effect-item {
            display: flex;
            align-items: center;
            height: var(--row-height);
            padding: 0 16px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            cursor: grab;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0.4;
        }

        .effect-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.12);
            opacity: 0.7;
        }

        .effect-item.active {
            opacity: 1;
            background: rgba(255, 255, 255, 0.07);
            border-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .effect-item.dragging {
            opacity: 0.5;
            transform: scale(0.98);
            border-style: dashed;
        }

        .drag-handle {
            width: 20px;
            display: flex;
            flex-direction: column;
            gap: 3px;
            margin-right: 16px;
            color: #444;
        }

        .drag-handle span {
            width: 100%;
            height: 2px;
            background: currentColor;
            border-radius: 1px;
        }

        .effect-item:hover .drag-handle {
            color: #666;
        }

        .effect-name {
            flex: 1;
            font-size: 0.85rem;
            font-weight: 500;
            pointer-events: none;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .toggle {
            width: 38px;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            padding: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .toggle-indicator {
            width: 16px;
            height: 16px;
            background: #fff;
            border-radius: 50%;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), background 0.3s ease;
        }

        .effect-item.active .toggle {
            background: var(--accent-color);
            box-shadow: 0 0 15px var(--accent-glow);
        }

        .effect-item.active .toggle-indicator {
            transform: translateX(18px);
            background: #000;
        }

        ::-webkit-scrollbar {
            width: 5px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .toast {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            background: var(--accent-color);
            color: #000;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 700;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 100;
            box-shadow: 0 8px 24px var(--accent-glow);
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
    </style>
</head>

<body>

    <div class="container">
        <div class="pane-group">
            <div class="pane">
                <div class="pane-label">Input</div>
                <textarea id="inputText" placeholder="Enter text to transform..."></textarea>
            </div>

            <div class="pane">
                <div class="pane-label">Output</div>
                <div id="outputDisplay" class="output-content"></div>
                <button class="copy-btn" id="copyBtn">Copy Text</button>
            </div>
        </div>

        <aside class="stack-section">
            <div class="stack-header">
                <span>Effects</span>
                <span>DRAG TO REORDER</span>
            </div>
            <div class="stack-list" id="stackList">
                <!-- Effects injected by JS -->
            </div>
        </aside>
    </div>

    <div id="toast" class="toast">COPIED TO CLIPBOARD</div>

    <script>
        // Helper: simple character map replacer
        function mapChars(str, mapping) {
            return str.replace(/[a-zA-Z]/g, c => mapping[c] || c);
        }

        const effects = [
            // CASE STYLES
            { id: 'upper', name: 'Uppercase', fn: t => t.toUpperCase() },
            { id: 'lower', name: 'Lowercase', fn: t => t.toLowerCase() },
            { id: 'start', name: 'Start Case', fn: t => t.toLowerCase().replace(/(?:^|\s)\S/g, c => c.toUpperCase()) },
            { id: 'sentence', name: 'Sentence Case', fn: t => t.toLowerCase().replace(/(^\s*\w|[.!?]\s*\w)/g, c => c.toUpperCase()) },
            { id: 'title', name: 'Title Case', fn: t => t.toLowerCase().replace(/\b\w/g, c => c.toUpperCase()) },
            { id: 'invert', name: 'Invert Case', fn: t => t.replace(/[a-zA-Z]/g, c => c === c.toUpperCase() ? c.toLowerCase() : c.toUpperCase()) },
            { id: 'camel', name: 'Camel Case', fn: t => t.replace(/[_\-\s]+(.)?/g, (_, c) => c ? c.toUpperCase() : '').replace(/^[A-Z]/, c => c.toLowerCase()) },
            { id: 'snake', name: 'Snake Case', fn: t => t.trim().replace(/[\s\-_]+/g, '_').toLowerCase() },
            { id: 'kebab', name: 'Kebab Case', fn: t => t.trim().replace(/[\s\-_]+/g, '-').toLowerCase() },
            { id: 'dot', name: 'Dot Case', fn: t => t.trim().replace(/[\s\-_]+/g, '.').toLowerCase() },

            // CHARACTER/WORD SPACING & REMOVAL
            { id: 'space-char', name: 'Space Between Characters', fn: t => t.split('').join(' ') },
            { id: 'no-space', name: 'No Spaces', fn: t => t.replace(/\s+/g, '') },
            { id: 'space-word', name: 'Expand Camel/Pascal', fn: t => t.replace(/([a-z])([A-Z])/g, '$1 $2') },

            // REPEAT / DUPLICATE
            { id: 'repeat2', name: 'Repeat x2', fn: t => t + t },
            { id: 'double-char', name: 'Double Each Character', fn: t => t.split('').map(c => c + c).join('') },

            // SHUFFLE / SCRAMBLE
            { id: 'scramble', name: 'Scramble Characters', fn: t => t.split('').sort(() => Math.random() - 0.5).join('') },
            { id: 'shuffle-words', name: 'Scramble Words Content', fn: t => t.split(/(\s+)/).map(w => /\S/.test(w) ? w.split('').sort(() => Math.random() - 0.5).join('') : w).join('') },

            // ENCODINGS / OBFUSCATION
            {
                id: 'rot13', name: 'ROT13 Cipher', fn: t => t.replace(/[a-zA-Z]/g, c => {
                    const base = c <= 'Z' ? 65 : 97;
                    return String.fromCharCode(((c.charCodeAt(0) - base + 13) % 26) + base);
                })
            },
            { id: 'base64', name: 'Base64 Encode', fn: t => btoa(unescape(encodeURIComponent(t))) },
            { id: 'hex', name: 'Hexadecimal', fn: t => t.split('').map(c => c.charCodeAt(0).toString(16).padStart(2, '0')).join(' ') },
            {
                id: 'html-entity', name: 'HTML Entities', fn: t => t.replace(/[&<>"']/g, c => ({
                    '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
                }[c]))
            },

            // CODE / SYMBOLS
            {
                id: 'morse', name: 'Morse Code', fn: t => {
                    const map = {
                        'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.', 'F': '..-.',
                        'G': '--.', 'H': '....', 'I': '..', 'J': '.---', 'K': '-.-', 'L': '.-..',
                        'M': '--', 'N': '-.', 'O': '---', 'P': '.--.', 'Q': '--.-', 'R': '.-.',
                        'S': '...', 'T': '-', 'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-',
                        'Y': '-.--', 'Z': '--..',
                        '0': '-----', '1': '.----', '2': '..---', '3': '...--', '4': '....-',
                        '5': '.....', '6': '-....', '7': '--...', '8': '---..', '9': '----.',
                        ' ': '/'
                    };
                    return t.toUpperCase().split('').map(c => map[c] || c).join(' ');
                }
            },
            {
                id: 'braille', name: 'Braille Script', fn: t => {
                    const map = {
                        'a': '‚†Å', 'b': '‚†É', 'c': '‚†â', 'd': '‚†ô', 'e': '‚†ë', 'f': '‚†ã', 'g': '‚†õ', 'h': '‚†ì', 'i': '‚†ä', 'j': '‚†ö',
                        'k': '‚†Ö', 'l': '‚†á', 'm': '‚†ç', 'n': '‚†ù', 'o': '‚†ï', 'p': '‚†è', 'q': '‚†ü', 'r': '‚†ó', 's': '‚†é', 't': '‚†û',
                        'u': '‚†•', 'v': '‚†ß', 'w': '‚†∫', 'x': '‚†≠', 'y': '‚†Ω', 'z': '‚†µ'
                    };
                    return t.toLowerCase().split('').map(c => map[c] || c).join('');
                }
            },

            // STYLISTIC
            {
                id: 'leet', name: 'Leetspeak', fn: t => mapChars(t.toLowerCase(), {
                    'a': '4', 'e': '3', 'i': '1', 'o': '0', 's': '5', 't': '7', 'l': '1', 'b': '8', 'g': '9'
                })
            },
            {
                id: 'wide', name: 'Vaporwave / Fullwidth', fn: t => {
                    return t.split('').map(c => {
                        const code = c.charCodeAt(0);
                        return (code >= 33 && code <= 126) ? String.fromCharCode(code + 65248) : c;
                    }).join('');
                }
            },
            {
                id: 'upside-down', name: 'Upside Down', fn: t => {
                    const map = {
                        'a': '…ê', 'b': 'q', 'c': '…î', 'd': 'p', 'e': '«ù', 'f': '…ü', 'g': '∆É', 'h': '…•', 'i': '·¥â', 'j': '…æ',
                        'k': ' û', 'l': 'l', 'm': '…Ø', 'n': 'u', 'o': 'o', 'p': 'd', 'q': 'b', 'r': '…π', 's': 's', 't': ' á',
                        'u': 'n', 'v': ' å', 'w': ' ç', 'x': 'x', 'y': ' é', 'z': 'z',
                        'A': '‚àÄ', 'B': 'êêí', 'C': '‚ÜÉ', 'D': 'êêì', 'E': '∆é', 'F': '‚Ñ≤', 'G': '‚ÖÅ', 'H': 'H', 'I': 'I', 'J': '≈ø',
                        'K': ' û', 'L': 'À•', 'M': 'W', 'N': 'N', 'O': 'O', 'P': '‘Ä', 'Q': '√í', 'R': 'R', 'S': 'S', 'T': '‚î¥',
                        'U': '‚à©', 'V': 'Œõ', 'W': 'M', 'X': 'X', 'Y': '‚ÖÑ', 'Z': 'Z',
                        '0': '0', '1': '∆ñ', '2': '·ÑÖ', '3': '∆ê', '4': 'h', '5': 'S', '6': '9', '7': 'L', '8': '8', '9': '6',
                        '?': '¬ø', '!': '¬°', '"': '‚Äû', "'": ',', '(': ')', ')': '(', '[': ']', ']': '[', '{': '}', '}': '{',
                        '<': '>', '>': '<', '.': 'Àô', ',': "'"
                    };
                    return t.split('').map(c => map[c] || c).reverse().join('');
                }
            },

            // ALTERNATING
            { id: 'toggle-char', name: 'SpongeBob Case', fn: t => t.split('').map((c, i) => i % 2 === 0 ? c.toUpperCase() : c.toLowerCase()).join('') },

            // FILTERS
            { id: 'no-vowels', name: 'Remove Vowels', fn: t => t.replace(/[aeiouAEIOU]/g, '') },
            { id: 'letters-only', name: 'Letters Only', fn: t => t.replace(/[^a-zA-Z\s]/g, '') },
        ];

        const inputText = document.getElementById('inputText');
        const outputDisplay = document.getElementById('outputDisplay');
        const stackList = document.getElementById('stackList');
        const copyBtn = document.getElementById('copyBtn');
        const toast = document.getElementById('toast');

        function init() {
            renderStack();
            inputText.focus();
            inputText.addEventListener('input', process);
            copyBtn.addEventListener('click', copyToClipboard);
        }

        function renderStack() {
            stackList.innerHTML = '';
            effects.forEach((effect, index) => {
                const item = document.createElement('div');
                item.className = 'effect-item';
                item.draggable = true;
                item.dataset.id = effect.id;

                item.innerHTML = `
                <div class="drag-handle"><span></span><span></span><span></span></div>
                <div class="effect-name">${effect.name}</div>
                <div class="toggle" role="switch">
                    <div class="toggle-indicator"></div>
                </div>
            `;

                const toggleBtn = item.querySelector('.toggle');
                toggleBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    item.classList.toggle('active');
                    process();
                });

                // Add DnD listeners
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragover', handleDragOver);
                item.addEventListener('dragend', handleDragEnd);
                item.addEventListener('drop', handleDrop);

                stackList.appendChild(item);
            });
        }

        function process() {
            let text = inputText.value;
            if (!text) {
                outputDisplay.textContent = '';
                return;
            }

            const items = Array.from(stackList.children);
            for (const item of items) {
                if (item.classList.contains('active')) {
                    const id = item.dataset.id;
                    const effect = effects.find(e => e.id === id);
                    if (effect) {
                        try {
                            text = effect.fn(text);
                        } catch (err) {
                            console.error(`Error in effect ${id}:`, err);
                        }
                    }
                }
            }

            outputDisplay.textContent = text;
        }

        let dragSrcEl = null;

        function handleDragStart(e) {
            this.classList.add('dragging');
            dragSrcEl = this;
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragOver(e) {
            if (e.preventDefault) e.preventDefault();
            const afterElement = getDragAfterElement(stackList, e.clientY);
            const draggable = document.querySelector('.dragging');
            if (afterElement == null) {
                stackList.appendChild(draggable);
            } else {
                stackList.insertBefore(draggable, afterElement);
            }
            return false;
        }

        function handleDrop(e) {
            if (e.stopPropagation) e.stopPropagation();
            process();
            return false;
        }

        function handleDragEnd() {
            this.classList.remove('dragging');
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.effect-item:not(.dragging)')];
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function copyToClipboard() {
            const text = outputDisplay.textContent;
            if (!text) return;
            navigator.clipboard.writeText(text).then(() => {
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 2000);
            });
        }

        init();
    </script>
</body>

</html>