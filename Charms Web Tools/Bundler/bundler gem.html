<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Static Asset Minifier & Bundler (V2)</title><meta name="viewport" content="width=device-width,initial-scale=1"><script src="https://cdn.tailwindcss.com"></script><style>:root{--bg-dark:#0a0a0c;--card-bg:#141417;--border:#2d2d32;--accent:#3b82f6;--accent-hover:#2563eb;--text-muted:#94a3b8}body{background-color:var(--bg-dark);color:#e2e8f0;font-family:Inter,system-ui,-apple-system,sans-serif}.glass-card{background:var(--card-bg);border:1px solid var(--border);border-radius:8px}.editor-area{background:#000;color:#d1d5db;border:1px solid var(--border);transition:all .2s ease;font-family:'Fira Code','Courier New',monospace}.editor-area:focus{outline:0;border-color:var(--accent)}.drop-zone-active{border:2px dashed var(--accent)!important;background:rgba(59,130,246,.08)!important}.tab-btn{transition:all .2s;border-bottom:2px solid transparent}.tab-btn.active{color:var(--accent);border-bottom-color:var(--accent);background:rgba(59,130,246,.05)}.asset-item{transition:all .2s;border-left:2px solid transparent}.asset-item.active{background:#1e293b;border-left-color:var(--accent)}.log-line{border-left:1px solid var(--border);padding-left:12px}#usageModalOverlay{background:rgba(0,0,0,.85);backdrop-filter:blur(4px)}.modal-section-header{font-size:10px;font-weight:800;letter-spacing:.1em;text-transform:uppercase;padding:8px 0;margin-bottom:8px}.usage-badge{font-size:9px;padding:2px 6px;border-radius:4px;font-weight:700}::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-track{background:var(--bg-dark)}::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}</style></head><body class="p-4 md:p-8" id="dropBoundary"><div class="max-w-6xl mx-auto"><header class="mb-10 border-b border-zinc-800 pb-6"><div class="flex items-center gap-3"><div class="w-2 h-8 bg-blue-600 rounded"></div><h1 class="text-xl font-bold tracking-tight text-white uppercase">Static Asset Minifier & Bundler</h1></div><p class="text-sm text-slate-400 mt-2 max-w-2xl">High-performance frontend asset pipeline. Supports bulk file imports, path normalization, and automatic Base64 inlining for single-file distribution.</p></header><div class="glass-card overflow-hidden"><nav class="flex border-b border-zinc-800 bg-zinc-900/30"><button class="tab-btn active px-6 py-4 text-[10px] font-bold uppercase tracking-widest" data-tab="workspace">Workspace</button> <button class="tab-btn px-6 py-4 text-[10px] font-bold uppercase tracking-widest" data-tab="output">Build Output</button> <button class="tab-btn px-6 py-4 text-[10px] font-bold uppercase tracking-widest" data-tab="log">Process Logs</button></nav><main class="p-0"><section id="workspace" class="tab-content block h-[600px] flex"><div class="w-64 border-r border-zinc-800 flex flex-col bg-zinc-900/10"><div class="p-4 border-b border-zinc-800 flex justify-between items-center"><span class="text-[10px] font-bold uppercase text-zinc-500 tracking-widest">Assets</span><div class="flex gap-2"><button id="addHtml" class="text-[9px] text-zinc-400 hover:text-blue-400 font-bold px-1">+HTML</button> <button id="addCss" class="text-[9px] text-zinc-400 hover:text-blue-400 font-bold px-1">+CSS</button> <button id="addJs" class="text-[9px] text-zinc-400 hover:text-blue-400 font-bold px-1">+JS</button></div></div><div id="assetList" class="flex-1 overflow-y-auto"></div></div><div class="flex-1 flex flex-col relative"><div id="noAssetPrompt" class="absolute inset-0 z-10 bg-zinc-900/90 flex flex-col items-center justify-center p-12 text-center"><svg class="w-12 h-12 text-zinc-700 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg><h3 class="text-sm font-bold text-zinc-400 uppercase tracking-widest mb-2">No Assets Loaded</h3><p class="text-xs text-zinc-600 max-w-xs leading-relaxed">Drag and drop files to begin. JS files are now protected from corruption during image inlining.</p></div><div id="editorHeader" class="hidden p-3 border-b border-zinc-800 bg-zinc-900/20 flex items-center justify-between"><span id="currentFileName" class="text-xs font-mono text-blue-400">Select an asset</span> <button id="removeAsset" class="text-[10px] font-bold text-red-900 hover:text-red-500 uppercase">Delete File</button></div><textarea id="mainEditor" class="editor-area hidden flex-1 w-full p-6 text-sm resize-none" placeholder="Paste code here..."></textarea><div id="mediaView" class="hidden flex-1 flex flex-col items-center justify-center bg-black p-10 overflow-hidden"><div class="text-[10px] font-bold text-zinc-500 mb-4 uppercase tracking-widest">Binary Asset Preview</div><img id="imgPreview" class="max-w-full max-h-[300px] rounded border border-zinc-800 shadow-2xl mb-4" src="" alt=""><div id="base64Summary" class="text-[10px] font-mono text-zinc-600 break-all max-w-md text-center"></div></div><div id="dropOverlay" class="absolute inset-0 pointer-events-none border-4 border-transparent flex items-center justify-center transition-all"><div class="bg-blue-600 text-white px-8 py-4 rounded-full text-xs font-bold opacity-0 transition-opacity uppercase tracking-widest shadow-2xl scale-95 transform">Drop to Import</div></div></div></section><section id="output" class="tab-content hidden p-6 space-y-6"><div class="flex flex-wrap items-center gap-6 bg-zinc-900/50 p-5 rounded border border-zinc-800"><div class="flex flex-col gap-1"><span class="text-[10px] font-bold text-slate-500 uppercase tracking-tighter">Build Configuration</span> <select id="mode" class="bg-black border border-zinc-700 text-xs rounded px-3 py-2 outline-none focus:border-blue-500"><option value="inline">Single HTML Bundle (Inline Assets)</option><option value="separate">Multi-file Minification (Standard)</option></select></div><button id="build" class="bg-blue-600 hover:bg-blue-500 text-white text-xs font-bold py-2.5 px-10 rounded transition-all active:scale-95 uppercase tracking-widest">Run Build</button><div id="build-status" class="hidden text-blue-400 text-[10px] font-bold uppercase tracking-widest">Optimizing...</div></div><div class="space-y-4"><button id="togglePreview" class="w-full flex items-center justify-between p-3 bg-zinc-800/20 border border-zinc-700 rounded text-[10px] font-bold uppercase tracking-widest hover:bg-zinc-800/40"><span>Toggle Live Preview</span> <span class="text-zinc-500">View</span></button><div id="previewBox" class="hidden overflow-hidden rounded border border-zinc-800 h-[400px] bg-white shadow-inner"><iframe id="previewFrame" class="w-full h-full border-none" sandbox="allow-scripts"></iframe></div><div class="grid grid-cols-2 md:grid-cols-4 gap-4"><button id="downH" class="p-4 bg-zinc-900 border border-zinc-800 rounded hover:border-zinc-500 text-[10px] font-bold uppercase">HTML</button> <button id="downC" class="p-4 bg-zinc-900 border border-zinc-800 rounded hover:border-zinc-500 text-[10px] font-bold uppercase">CSS</button> <button id="downJ" class="p-4 bg-zinc-900 border border-zinc-800 rounded hover:border-zinc-500 text-[10px] font-bold uppercase">JS</button> <button id="downA" class="p-4 bg-blue-900/20 border border-blue-800/50 rounded hover:bg-blue-900/30 text-[10px] font-bold uppercase text-blue-400">Bundle All</button></div></div></section><section id="log" class="tab-content hidden p-6"><div id="logBox" class="editor-area w-full h-96 p-4 rounded overflow-y-auto text-[11px] font-mono leading-relaxed"><div class="text-zinc-600 italic">No logs recorded yet.</div></div></section></main></div></div><div id="usageModalOverlay" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4"><div class="glass-card w-full max-w-2xl max-h-[80vh] flex flex-col shadow-2xl"><div class="p-6 border-b border-zinc-800"><h2 class="text-sm font-bold uppercase tracking-[0.2em] text-white">Image Usage Review</h2><p class="text-[11px] text-zinc-500 mt-1">Review which assets are referenced in your code before proceeding with the build.</p></div><div class="flex-1 overflow-y-auto p-6 space-y-8"><div id="referencedSection"><h3 class="modal-section-header text-emerald-500 border-b border-emerald-900/30">Referenced Assets</h3><div id="referencedList" class="space-y-2 mt-4"></div></div><div id="unreferencedSection"><h3 class="modal-section-header text-amber-500 border-b border-amber-900/30">Unused Assets (Will be removed)</h3><div id="unreferencedList" class="space-y-2 mt-4"></div></div></div><div class="p-6 border-t border-zinc-800 flex gap-4"><button id="modalCancel" class="flex-1 py-3 bg-zinc-800 hover:bg-zinc-700 text-zinc-300 text-[10px] font-bold uppercase tracking-widest rounded">Cancel</button> <button id="modalProceed" class="flex-1 py-3 bg-blue-600 hover:bg-blue-500 text-white text-[10px] font-bold uppercase tracking-widest rounded shadow-lg shadow-blue-900/20">Proceed & Clean Build</button></div></div></div><script type="module">import{minify as minifyHTML}from"https://esm.sh/html-minifier-terser";import CleanCSS from"https://esm.sh/clean-css";import{minify as minifyJS}from"https://esm.sh/terser";let assets=[],activeAssetId=null,outputs={html:"",css:"",js:""};const logBox=document.getElementById("logBox"),assetList=document.getElementById("assetList"),mainEditor=document.getElementById("mainEditor"),mediaView=document.getElementById("mediaView"),imgPreview=document.getElementById("imgPreview"),base64Summary=document.getElementById("base64Summary"),currentFileName=document.getElementById("currentFileName"),buildStatus=document.getElementById("build-status"),noAssetPrompt=document.getElementById("noAssetPrompt"),editorHeader=document.getElementById("editorHeader"),usageModal=document.getElementById("usageModalOverlay"),refList=document.getElementById("referencedList"),unrefList=document.getElementById("unreferencedList"),modalProceed=document.getElementById("modalProceed"),modalCancel=document.getElementById("modalCancel"),log=e=>{1===logBox.children.length&&logBox.querySelector(".italic")&&(logBox.innerHTML="");const t=document.createElement("div");t.className="log-line text-zinc-400 py-1 mb-1";const s=(new Date).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});t.innerHTML=`<span class="text-zinc-600 font-mono mr-3">${s}</span> ${e}`,logBox.appendChild(t),logBox.scrollTop=logBox.scrollHeight},renderAssetList=()=>{if(assetList.innerHTML="",0===assets.length)return noAssetPrompt.classList.remove("hidden"),editorHeader.classList.add("hidden"),mainEditor.classList.add("hidden"),void mediaView.classList.add("hidden");noAssetPrompt.classList.add("hidden"),editorHeader.classList.remove("hidden"),assets.forEach(e=>{const t=document.createElement("div");t.className="asset-item px-4 py-3 cursor-pointer border-b border-zinc-800/50 flex justify-between items-center "+(e.id===activeAssetId?"active":""),t.innerHTML=`\n      <span class="text-xs font-mono truncate mr-2 ${e.id===activeAssetId?"text-white":"text-zinc-500"}">${e.name}</span>\n      <span class="text-[8px] px-1 bg-zinc-800 rounded font-bold uppercase text-zinc-400">${e.type}</span>\n    `,t.onclick=()=>selectAsset(e.id),assetList.appendChild(t)})},selectAsset=e=>{if(!e)return activeAssetId=null,void renderAssetList();const t=assets.find(e=>e.id===activeAssetId);t&&"media"!==t.type&&(t.content=mainEditor.value),activeAssetId=e;const s=assets.find(t=>t.id===e);s&&(currentFileName.innerText=s.name,"media"===s.type?(mainEditor.classList.add("hidden"),mediaView.classList.remove("hidden"),imgPreview.src=s.content,base64Summary.innerText=s.content.substring(0,80)+"..."):(mainEditor.classList.remove("hidden"),mediaView.classList.add("hidden"),mainEditor.value=s.content),renderAssetList())},addAsset=(e,t,s)=>{const n=crypto.randomUUID();assets.push({id:n,type:e,name:t,content:s}),log(`Successfully imported: <span class="text-blue-400">${t}</span>`),selectAsset(n)};document.getElementById("addHtml").onclick=()=>addAsset("html",`page-${assets.filter(e=>"html"===e.type).length+1}.html`,""),document.getElementById("addCss").onclick=()=>addAsset("css",`style-${assets.filter(e=>"css"===e.type).length+1}.css`,""),document.getElementById("addJs").onclick=()=>addAsset("js",`script-${assets.filter(e=>"js"===e.type).length+1}.js`,""),document.getElementById("removeAsset").onclick=()=>{assets=assets.filter(e=>e.id!==activeAssetId),assets.length>0?selectAsset(assets[assets.length-1].id):selectAsset(null)},document.querySelectorAll(".tab-btn").forEach(e=>{e.onclick=()=>{document.querySelectorAll(".tab-btn").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(e=>e.classList.add("hidden")),e.classList.add("active"),document.getElementById(e.dataset.tab).classList.remove("hidden")}});const dropBoundary=document.getElementById("dropBoundary"),dropOverlay=document.getElementById("dropOverlay");dropBoundary.addEventListener("dragover",e=>{e.preventDefault(),dropOverlay.classList.add("drop-zone-active"),dropOverlay.firstElementChild.style.opacity="1",dropOverlay.firstElementChild.style.transform="scale(1)"}),dropBoundary.addEventListener("dragleave",e=>{null!==e.relatedTarget&&e.relatedTarget!==dropBoundary||(dropOverlay.classList.remove("drop-zone-active"),dropOverlay.firstElementChild.style.opacity="0")}),dropBoundary.addEventListener("drop",async e=>{e.preventDefault(),dropOverlay.classList.remove("drop-zone-active"),dropOverlay.firstElementChild.style.opacity="0";const t=Array.from(e.dataTransfer.files);if(0!==t.length)for(const e of t){const t=e.name.split(".").pop().toLowerCase();if(["png","jpg","jpeg","gif","svg","webp","ico"].includes(t)){const t=new FileReader;t.onload=t=>addAsset("media",e.name,t.target.result),t.readAsDataURL(e)}else{const s=await e.text();["html","htm"].includes(t)?addAsset("html",e.name,s):"css"===t?addAsset("css",e.name,s):"js"===t&&addAsset("js",e.name,s)}}});const scanImageUsage=()=>{const e=assets.filter(e=>"media"===e.type),t=assets.filter(e=>"html"===e.type).map(e=>e.content).join(" "),s=assets.filter(e=>"css"===e.type).map(e=>e.content).join(" "),n=[],d=[];return e.forEach(e=>{const a=e.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=new RegExp(`(src|href)=["']([^"']*\\/)?${a}["']`,"i"),i=new RegExp(`url\\(\\s*["']?([^"')]*\\/)?${a}["']?\\s*\\)`,"i");let l=[];o.test(t)&&l.push("HTML"),i.test(s)&&l.push("CSS"),l.length>0?n.push({...e,foundIn:l}):d.push(e)}),{used:n,unused:d}},showUsageModal=(e,t)=>{refList.innerHTML="",unrefList.innerHTML="",e.forEach(e=>{const t=document.createElement("div");t.className="flex items-center gap-3 bg-emerald-500/5 border border-emerald-500/20 p-2 rounded",t.innerHTML=`\n            <img src="${e.content}" class="w-8 h-8 object-cover rounded">\n            <span class="text-xs font-mono text-emerald-400 flex-1">${e.name}</span>\n            <span class="usage-badge bg-emerald-500/20 text-emerald-400 uppercase">In ${e.foundIn.join(" & ")}</span>\n        `,refList.appendChild(t)}),t.forEach(e=>{const t=document.createElement("div");t.className="flex items-center gap-3 bg-amber-500/5 border border-amber-500/20 p-2 rounded opacity-80",t.innerHTML=`\n            <img src="${e.content}" class="w-8 h-8 object-cover rounded">\n            <span class="text-xs font-mono text-amber-500 flex-1">${e.name}</span>\n            <span class="usage-badge bg-amber-500/20 text-amber-500 uppercase">Unused</span>\n        `,unrefList.appendChild(t)}),usageModal.classList.remove("hidden")};modalCancel.onclick=()=>usageModal.classList.add("hidden"),modalProceed.onclick=()=>{usageModal.classList.add("hidden");const{unused:e}=scanImageUsage();assets=assets.filter(t=>!e.find(e=>e.id===t.id)),renderAssetList(),log(`Purged ${e.length} unused media assets.`),executeBuild()},document.getElementById("build").onclick=()=>{const e=assets.find(e=>e.id===activeAssetId);e&&"media"!==e.type&&(e.content=mainEditor.value);const{used:t,unused:s}=scanImageUsage();s.length>0?showUsageModal(t,s):executeBuild()};const executeBuild=async()=>{const e=assets.find(e=>"html"===e.type);if(!e)return void log("<span class='text-red-500'>Error:</span> No HTML entry found.");buildStatus.classList.remove("hidden"),log("Starting protected build sequence...");const t=document.getElementById("mode").value;let s=e.content,n=assets.filter(e=>"css"===e.type).map(e=>e.content).join("\n"),d=assets.filter(e=>"js"===e.type).map(e=>e.content).join("\n");const a=assets.filter(e=>"media"===e.type);try{n&&(n=(new CleanCSS).minify(n).styles),d&&(d=(await minifyJS(d)).code),"inline"===t&&a.length>0&&(log(`Inlining ${a.length} assets into HTML/CSS...`),a.forEach(e=>{const t=e.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),d=new RegExp(`(['"\\(])(?:[^'"\\(\\)]*?\\/)?${t}(['"\\)])`,"g"),a=(t,s,n)=>`${s}${e.content}${n}`;s=s.replace(d,a),n&&(n=n.replace(d,a))})),"inline"===t&&(n&&(s=s.replace("</head>",`<style>${n}</style></head>`)),d&&(s=s.replace("</body>",`<script>${d}<\/script></body>`))),s=await minifyHTML(s,{collapseWhitespace:!0,removeComments:!0,minifyCSS:!0,minifyJS:!0}),outputs={html:s,css:n,js:d},document.getElementById("previewFrame").srcdoc=s,log("<span class='text-green-500 font-bold'>Build Complete.</span> Outputs generated."),document.querySelector('[data-tab="output"]').click()}catch(e){log(`<span class="text-red-500">Error:</span> ${e.message}`)}finally{buildStatus.classList.add("hidden")}},dl=(e,t)=>{if(!t)return;const s=document.createElement("a");s.href=URL.createObjectURL(new Blob([t],{type:"text/plain"})),s.download=e,s.click()};document.getElementById("downH").onclick=()=>dl("index.min.html",outputs.html),document.getElementById("downC").onclick=()=>dl("styles.min.css",outputs.css),document.getElementById("downJ").onclick=()=>dl("scripts.min.js",outputs.js),document.getElementById("downA").onclick=()=>{dl("index.min.html",outputs.html),outputs.css&&dl("styles.min.css",outputs.css),outputs.js&&dl("scripts.min.js",outputs.js)},document.getElementById("togglePreview").onclick=()=>{document.getElementById("previewBox").classList.toggle("hidden")},renderAssetList()</script></body></html>